<?xml version="1.0" encoding="utf-8"?>
<?xsl-stylesheet type="text/xsl" href="../transforms/xsl/module/module2html.xsl"?>

<?xml-model href="../transforms/schemas/CCModule.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>



<Module boilerplate="yes" target-product="Wireless Local Area Network (WLAN) Access System" 
  name="Wireless Local Area Network (WLAN) Access System"
  xmlns="https://niap-ccevs.org/cc/v1"
  xmlns:sec="https://niap-ccevs.org/cc/v1/section"
  xmlns:h="http://www.w3.org/1999/xhtml">
 
  <PPReference>
    <ReferenceTable>
      <PPVersion>2.0</PPVersion>
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate>2025-03-31</PPPubDate>
      <Keywords>WLAN, Wireless LAN</Keywords>
    </ReferenceTable>
  </PPReference>
  <RevisionHistory>
    
    <entry>
      <version>0.5</version>
      <date>2022-01-20</date>
      <subject>Conversion to PP-Module; <h:br/> 
        Updated to include WPA 3 and Wi-Fi 6. <h:br/>
        WPA 3 is required. WPA 2 can additionally be included in the ST.<h:br/>
        256 bit keys are required. 128 and 192 bit keys can additionally be included in the ST.<h:br/>
        Mandated Distributed TOE</subject>
    </entry>
    
    <entry>
      <version>1.0</version>
      <date>2022-03-31</date>
      <subject>Initial Release</subject>
    </entry>
    
    <entry>
      <version>2.0</version>
      <date>2025-03-31</date>
      <subject>Incorporate NIAP Technical Decisions, Update to CC:2022</subject>
    </entry>
        
  </RevisionHistory>
  
  <include-pkg id="pkgTLS">
    <git>
      <url>https://github.com/commoncriteria/tls/</url>
      <branch>release-2.1</branch>
    </git>
    <url>https://www.niap-ccevs.org/protectionprofiles/465</url>
  </include-pkg>
  
  <!-- TODO: no open items -->
  
  <sec:Introduction>
    <sec:Overview>
      <h:p>
      The scope of this PP-Module is to describe the security functionality of a Wireless Local Area Network (WLAN) Access System (AS) in terms of <xref g='CC'/>
      and to define functional and assurance requirements for such products.
      This PP-Module is intended for use with the following Base-PP:
      <h:ul>
        <h:li>Network Device collaborative Protection Profile Version 4.0</h:li>
      </h:ul>
      This Base-PP is valid because a WLAN AS is a device at the edge of a private network that establishes an encrypted IEEE 802.11 link that protects wireless data in transit from disclosure and modification. 
      A network device typically implements this functionality.
      </h:p>
      <!-- 
	   post-process.py cannot find find "access points" and thus will attempt to define
	   AP when it finds it.
      -->
      <h:span style="display:none">Access Point (AP)</h:span>
      <h:p>
      A TOE that conforms to a Protection Profile Configuration (PP-Configuration) containing this PP-Module can either be a standalone or distributed TOE as defined in the NDcPP. 
      For distributed TOEs, the expectation for this PP-Module is that a WLAN AS is composed of a single controller and one or more access points (APs).
      </h:p>
      
    </sec:Overview>
    <tech-terms>
      <suppress>Functional Package,Extended Package</suppress>
      <term abbr="AES"   full="Advanced Encryption Standard"/>
      <term abbr="AP"    full="Access Point" plural="APs">
        A device that provides the network interface that enables
        wireless client hosts to access a wired network. </term>
      <term abbr="AS"    full="Access System" plural="ASes"/>
      <term abbr="CBC"   full="Cipher Block Chaining"/>
      <term abbr="CCM"   full="Counter Mode with CBC-Message Authentication Code"/>
      <term abbr="CCMP"  full="CCM mode Protocol"/>
      <term abbr="CTR"   full="Counter (encryption mode)"/>
      <term abbr="EAP"   full="Extensible Authentication Protocol"/>
      <term abbr="GCM"   full="Galois-Counter Mode"/>
      <term abbr="GTK"   full="Group Temporal Key"/>
      <term abbr="IPsec" full="Internet Protocol Security"/>
      <term abbr="MAC"   full="Media Access Control"/>
      <term abbr="NDcPP" full="Network Device collaborative Protection Profile"/>
      <term abbr="PAE"   full="Port Access Entity"/>
      <term abbr="PMK"   full="Pairwise Master Key"/>
      <term abbr="PTK"   full="Pairwise Transient Key"/>
      <term abbr="RADIUS" full="Remote Authentication Dial In User Service"/>
      <term abbr="RBG"   full="Random Bit Generator"/>
      <term abbr="SSID"  full="Service Set Identifier"> 
        The primary name associated with an 802.11
        wireless local area network (WLAN). </term>
      <term abbr="TLS"   full="Transport Layer Security"/>
      <term abbr="WLAN"  full="Wireless Local Area Network"> 
        A wireless computer network that links
        two or more devices using wireless communication to form a local area network within a
        limited area such as a home, school, computer laboratory, campus, office building,
	etc.
      </term>
      <term abbr="WPA"   full="Wi-Fi Protected Access"/>
    </tech-terms>
    <sec:Compliant_Targets_of_Evaluation>
      <sec:TOE_Boundary>
	<h:p>
        This PP-Module specifically addresses WLAN (IEEE 802.11) ASes. A compliant WLAN AS is a
        system composed of hardware and software that is connected to a network and has an infrastructure
        role in the overall enterprise network. In particular, a WLAN AS establishes a secure wireless
        (IEEE 802.11) link that provides an authenticated and encrypted path to an enterprise network and
        thereby decreases the risk of exposure of information transiting “over-the-air”.
	</h:p>
	<h:p>
        Since this PP-Module extends the NDcPP, conformant TOEs are obligated to implement the functionality
        required in the NDcPP along with the additional functionality defined in this PP-Module in
	response to the threat environment discussed subsequently herein.
	</h:p>
      </sec:TOE_Boundary>
    </sec:Compliant_Targets_of_Evaluation>
    
    <sec:Use_Cases>
      <usecases>
        <usecase id="usecase-standalone" title="Standalone Device">
        <description>
        The TOE is a standalone network device that serves as a single network endpoint that provides connectivity to wireless clients.
        </description>
        </usecase>
        <usecase id="usecase-distributed" title="Distributed System">
          <description>The TOE is a distributed system consisting of multiple network devices that collectively serve as the wireless network endpoint. In addition to claiming the relevant "Distributed TOE" requirement in the NDcPP,
          this use case also requires the TOE to claim the optional SFR FCS_CKM.2/DISTRIB to describe the key distribution method between distributed TOE components.</description>
        </usecase>
        
      </usecases> 
    </sec:Use_Cases> 
  </sec:Introduction>
  <sec:Conformance_Claims boilerplate="no">
    <CClaimsInfo cc-version="cc-2022r1" cc-approach="direct-rationale">
      <cc-st-conf>exact</cc-st-conf>
      <cc-pt2-conf>extended</cc-pt2-conf>
      <cc-pt3-conf>conformant</cc-pt3-conf>
      <cc-pp-conf/>
      <cc-pp-config-with>
        <PP-cc-ref>Network Device collaborative Protection Profile Version 4.0</PP-cc-ref>
        <Mod-cc-ref>PP-Module for WLAN Client, Version 2.0</Mod-cc-ref>
      </cc-pp-config-with>
      <cc-pkg-claim>
        <FP-cc-ref conf="conformant">Functional Package for Transport Layer Security, Version 2.0</FP-cc-ref>
      </cc-pkg-claim>
    </CClaimsInfo>

  </sec:Conformance_Claims>
  <sec:Security_Problem_Definition>
    <h:p>
    This PP-Module is written to address the situation when network packets cross the boundary
    between a wired private network and a wireless client via a WLAN AS. The WLAN Access
    System provides secure communication between a user (wireless client) and a wired (trusted) network
    by supporting security functions such as administration, authentication, encryption, and the protection
    and handling of data in transit.
    To protect the data in transit from disclosure and modification, a WLAN
    AS is used to establish secure communications. The WLAN AS provides one end
    of the secure cryptographic tunnel and performs encryption and decryption of network packets in
    accordance with a WLAN AS security policy negotiated with its authenticated wireless client.
    It supports multiple simultaneous wireless connections and is capable of establishing and terminating
    multiple cryptographic tunnels to and from those peers.</h:p>
    <h:p>
    
    The proper installation, configuration, and administration of the WLAN AS are critical to its
    correct operation.</h:p>

    <h:p>
      Note that this PP-Module does not repeat the threats identified in the NDcPP,
      though they all apply given the conformance and hence dependence of this PP-Module on the NDcPP.
      Note also that while the NDcPP contains only threats to the ability of the TOE to provide its
      security functions, this PP-Module addresses only threats to resources in the Operational Environment (OE).
      Together the threats of the NDcPP and those defined in this PP-Module define the comprehensive set of
      security threats addressed by a WLAN AS TOE. 
    </h:p>
    <sec:Threats>
      <threats>
        <threat name="T.NETWORK_DISCLOSURE">
          <description>Devices on a protected network may be exposed to threats presented by devices located outside the
            protected network, which may attempt to conduct unauthorized activities. If malicious external devices
            are able to communicate with devices on the protected network, or if devices on the protected network
            can establish communications with those external devices
	    (e.g., as a result of nonexistent or insufficient  WLAN data encryption that exposes the WLAN data in
	    transit to rogue elements), then those internal
            devices may be susceptible to the unauthorized disclosure of information.</description>
          <consistency-rationale>This threat extends the security problem defined by the Base-PP to include the threat of a malicious entity in an untrusted network interacting with a protected entity in a trusted network. 
            This is not addressed in the Base-PP because not all network devices are responsible for facilitating communications between separate networks. This threat is also consistent with the T.UNTRUSTED_COMMUNICATION_CHANNELS
            threat defined by the Base-PP because compromise of data in transit is one potential way this threat may be exploited.</consistency-rationale>
          <addressed-by>FCS_COP.1/DataEncryption (modified from Base-PP)</addressed-by><rationale>Mitigates the threat by utilizing secure encryption and decryption algorithms to protect data.</rationale>         
          <addressed-by>FTP_ITC.1 (modified from Base-PP)</addressed-by><rationale>Mitigates the threat by utilizing a secure channel for administrative traffic (e.g., 802.1X traffic, audit server).</rationale>
          <addressed-by>FCS_CKM.1/WPA</addressed-by><rationale>Mitigates the threat by utilizing a secure key generation function for WPA functionality.</rationale>
          <addressed-by>FCS_CKM.2/GTK</addressed-by><rationale>Mitigates the threat by securely distributing GTK keys to clients.</rationale>
          <addressed-by>FCS_CKM.2/PMK</addressed-by><rationale>Mitigates the threat by securely receiving a key from an authentication server.</rationale>
          <addressed-by>FIA_8021X_EXT.1</addressed-by><rationale>Mitigates the threat by authenticating clients before allowing access to the controlled network.</rationale>
          <addressed-by>FIA_UAU.6</addressed-by><rationale>Mitigates the threat by re-authenticating users when specified criteria are met.</rationale>
          <addressed-by>FTA_TSE.1</addressed-by><rationale>Mitigates the threat by denying sessions based on undesirable characteristics.</rationale>
          <addressed-by>FTP_ITC.1/Client</addressed-by><rationale>Mitigates the threat by providing a secure channel for WLAN client traffic.</rationale>
          <addressed-by>FCS_CKM.2/DISTRIB (optional)</addressed-by><rationale>Mitigates the threat by securely distributing 802.11 keys to clients.</rationale>
          <addressed-by>FCS_RADSEC_EXT.1 (selection-based)</addressed-by><rationale>Mitigates the threat by utilizing a secure RADIUS implementation to authenticate clients.</rationale>
          <addressed-by>FCS_RADSEC_EXT.2 (selection-based)</addressed-by><rationale>Mitigates the threat by utilizing a secure TLS configuration for RADIUS over TLS.</rationale>
          <addressed-by>FCS_RADSEC_EXT.3 (selection-based)</addressed-by><rationale>Mitigates the threat by verifying server identifiers when utilizing RADIUS over TLS.</rationale>
          <addressed-by>FIA_PSK_EXT.1 (selection-based)</addressed-by><rationale>Mitigates the threat by generating and/or accepting secure pre-shared keys.</rationale>
        </threat>

        <threat name="T.NETWORK_ACCESS">
          <description>Devices located outside the protected network may seek to exercise services located on the protected
            network that are intended to be only accessed from inside the protected network or only accessed by
            entities using an authenticated path into the protected network.</description>
          <consistency-rationale>This threat extends the security problem defined by the Base-PP to include the threat of a malicious entity in an untrusted network interacting with a protected entity in a trusted network. 
            This is not addressed in the Base-PP because not all network devices are responsible for facilitating communications between separate networks.</consistency-rationale>
          <addressed-by>FIA_8021X_EXT.1</addressed-by><rationale>Mitigates the threat by authenticating clients before allowing access to the controlled network.</rationale>
          <addressed-by>FIA_UAU.6</addressed-by><rationale>Mitigates the threat by re-authenticating users when specified criteria are met.</rationale>
          <addressed-by>FMT_SMF.1/AccessSystem</addressed-by><rationale>Mitigates the threat by defining management functions that must be protected.</rationale>
          <addressed-by>FMT_SMR_EXT.1</addressed-by><rationale>Mitigates the threat by preventing remote administration functions from being exercised from a wireless client.</rationale>
          <addressed-by>FTA_TSE.1</addressed-by><rationale>Mitigates the threat by denying sessions based on undesirable characteristics.</rationale>
          <addressed-by>FCS_RADSEC_EXT.1 (selection-based)</addressed-by><rationale>Mitigates the threat by utilizing a secure RADIUS implementation to authenticate clients.</rationale>
          <addressed-by>FCS_RADSEC_EXT.2 (selection-based)</addressed-by><rationale>Mitigates the threat by utilizing a secure TLS configuration for RADIUS over TLS.</rationale>
          <addressed-by>FCS_RADSEC_EXT.3 (selection-based)</addressed-by><rationale>Mitigates the threat by verifying server identifiers when utilizing RADIUS over TLS.</rationale>
        </threat>

        <threat name="T.TSF_FAILURE">
          <description>Security mechanisms of the TOE generally build up from a primitive set of mechanisms (e.g., memory
            management, privileged modes of process execution) to more complex sets of mechanisms. Failure of
            the primitive mechanisms could lead to a compromise in more complex mechanisms, resulting in a
            compromise of the TSF. 
          </description>
          <consistency-rationale>This threat is an extension of the T.SECURITY_FUNCTIONALITY_FAILURE threat defined by the Base-PP.</consistency-rationale>
          <addressed-by>FPT_TST_EXT.1 (from Base-PP)</addressed-by><rationale>Mitigates the threat by defining a set of self-tests occur and a requirement for the TOE to fail sure in the event of a failure of any self-tests.</rationale>
          <addressed-by>FAU_GEN.1/WLAN</addressed-by><rationale>Mitigates the threat by notifying administrators of irregular operation that could indicate a failure.</rationale>
        </threat>
        
        <threat name="T.DATA_INTEGRITY">
          <description>Devices on a protected network may be exposed to threats presented by devices located outside the
            protected network, which may attempt to modify the data without authorization. If known malicious
            external devices are able to communicate with devices on the protected network or if devices on the
            protected network can establish communications with those external devices then the data contained
            within the communications may be susceptible to a loss of integrity.</description>
          <consistency-rationale>This threat is a specific type of failure that may result from successful exploitation of the T.WEAK_CRYPTOGRAPHY threat defined by the Base-PP. 
            It is an extension of the Base-PP threat for communications that are specific to this PP-Module.</consistency-rationale>
          <addressed-by>FCS_COP.1/DataEncryption (modified from Base-PP)</addressed-by><rationale>Mitigates the threat by encrypting data in transit to protect its confidentiality and integrity.</rationale>
          <addressed-by>FTP_ITC.1 (modified from Base-PP)</addressed-by><rationale>Mitigates the threat by utilizing a secure channel for administrative traffic (e.g., 802.1X traffic, audit server) that maintains data confidentiality and integrity.</rationale>
          <addressed-by>FCS_CKM.1/WPA</addressed-by><rationale>Mitigates the threat by generating a secure key used to encrypt and protect wireless traffic using WPA.</rationale>
          <addressed-by>FCS_CKM.2/GTK</addressed-by><rationale>Mitigates the threat by securely distributing GTK keys to clients so that they are not disclosed, maintaining the integrity of the data the key is used to protect.</rationale>
          <addressed-by>FCS_CKM.2/PMK</addressed-by><rationale>Mitigates the threat by securely receiving a key from an authentication server so that it is not disclosed, maintaining the integrity of the data the key is used to protect.</rationale>
          <addressed-by>FTP_ITC.1/Client</addressed-by><rationale>Mitigates the threat by providing a secure channel for WLAN client traffic that protects the confidentiality and integrity of the data.</rationale>
          <addressed-by>FCS_CKM.2/DISTRIB (optional)</addressed-by><rationale>Mitigates the threat by securely distributing 802.11 keys to clients so that they are not disclosed, maintaining the integrity of the data the key is used to protect.</rationale>
        </threat>
        
        <threat name="T.REPLAY_ATTACK">
          <description>If an unauthorized individual successfully gains access to the system, the adversary may have the
            opportunity to conduct a “replay” attack. This method of attack allows the individual to capture packets
            traversing throughout the wireless network and send the packets at a later time, possibly unknown by
            the intended receiver.</description>
          <consistency-rationale>This threat is a specific type of failure that may result from successful exploitation of the T.UNAUTHORIZED_ADMINISTRATOR_ACCESS and T.UNTRUSTED_COMMUNICATIONS_CHANNELS threats defined by the Base-PP. 
            It is an extension of the Base-PP threat for communications that are specific to this PP-Module.</consistency-rationale>
            <addressed-by>FCS_COP.1/DataEncryption (modified from Base-PP)</addressed-by><rationale>Mitigates the threat by utilizing secure encryption and decryption algorithms to protect data from disclosure, modification, or replay.</rationale>
            <addressed-by>FCS_CKM.1/WPA</addressed-by><rationale>Mitigates the threat by utilizing a secure key generation function for WPA functionality that is not subject to replay or guessing.</rationale>
            <addressed-by>FCS_CKM.2/GTK</addressed-by><rationale>Mitigates the threat by securely distributing GTK keys to clients so that they are not disclosed, maintaining confidentiality and preventing replay.</rationale>
            <addressed-by>FCS_CKM.2/PMK</addressed-by><rationale>Mitigates the threat by securely receiving a key from an authentication server so that it is not disclosed, maintaining confidentiality and preventing replay.</rationale>
            <addressed-by>FIA_8021X_EXT.1</addressed-by><rationale>Mitigates the threat by authenticating clients before allowing access to the controlled network and preventing replay of previous authentication sessions.</rationale>
            <addressed-by>FIA_UAU.6</addressed-by><rationale>Mitigates the threat by re-authenticating users when specified criteria are met, which can include if a specified time has passed or other indicators of stale authentication data.</rationale>
            <addressed-by>FTA_TSE.1</addressed-by><rationale>Mitigates the threat by denying sessions based on undesirable characteristics, which can include a detection of replay or other indicators of stale authentication data.</rationale>
            <addressed-by>FTP_ITC.1/Client</addressed-by><rationale>Mitigates the threat by providing a secure channel for WLAN client traffic that prevents the use of replayed data.</rationale>
            <addressed-by>FCS_CKM.2/DISTRIB (optional)</addressed-by><rationale>Mitigates the threat by securely distributing 802.11 keys to clients so that they are not disclosed, maintaining confidentiality and preventing replay.</rationale>
            <addressed-by>FCS_RADSEC_EXT.1 (selection-based)</addressed-by><rationale>Mitigates the threat by utilizing a secure RADIUS implementation to authenticate clients, which protects authentication data from replay attacks.</rationale>
            <addressed-by>FCS_RADSEC_EXT.2 (selection-based)</addressed-by><rationale>Mitigates the threat by utilizing a secure TLS configuration for RADIUS over TLS, which provides protection against replay and data modification.</rationale>
            <addressed-by>FCS_RADSEC_EXT.3 (selection-based)</addressed-by><rationale>Mitigates the threat by verifying server identifiers when utilizing RADIUS over TLS, preventing impersonation attacks that could lead to replay.</rationale>
        </threat>

      </threats>
    </sec:Threats>
    <sec:Assumptions>
      All assumptions for the OE of the Base-PP also apply to this PP-Module.
      A.NO_THRU_TRAFFIC_PROTECTION is still operative, but only for the interfaces in the TOE that are
      defined by the Base-PP and not the PP-Module.      
      <assumptions>
        <assumption name="A.CONNECTIONS">
          <description> It is assumed that the TOE is connected to distinct networks in a manner
            that ensures that the TOE's security policies will be enforced on all applicable network
            traffic flowing among the attached networks. </description>
          <consistency-rationale>The Base-PP does not define where in a particular network architecture a network device must be deployed since it is designed to be generic to various types of network devices. This PP-Module
            defines the expected architectural deployment specifically for WLAN AS network devices.</consistency-rationale>
          <objective-refer ref="OE.CONNECTIONS">
            <rationale> The OE objective OE.CONNECTIONS is realized through A.CONNECTIONS.</rationale>
          </objective-refer>
        </assumption>
      </assumptions>
    </sec:Assumptions>
    <sec:Organizational_Security_Policies>
      <!-- This PP-Module defines no additional organizational security policies beyond those specified in the NDcPP. -->
      <OSPs/>
    </sec:Organizational_Security_Policies>
  </sec:Security_Problem_Definition>
  <sec:Security_Objectives>      
    <sec:Security_Objectives_for_the_Operational_Environment>
      All objectives for the OE of the Base-PP also apply to this PP-Module.
      OE.NO_THRU_TRAFFIC_PROTECTION is still operative, but only for the interfaces in the TOE that are
      defined by the Base-PP and not the PP-Module.
      
      <SOEs>
        <SOE name="OE.CONNECTIONS">
          <description> TOE administrators will ensure that the TOE is installed in a manner that
            will allow the TOE to effectively enforce its policies on the network traffic of
            monitored networks. </description>
          <consistency-rationale>The Base-PP does not define where in a particular network architecture a network device must be deployed since it is designed to be generic to various types of network devices. This PP-Module
            defines the expected architectural deployment specifically for WLAN AS network devices.</consistency-rationale>
        </SOE>
      </SOEs>
    </sec:Security_Objectives_for_the_Operational_Environment>
    <sec:Security_Objectives_Rationale>
      <!-- NOTE: This section should remain empty and is populated from the rationale tags in the previous sections.  -->
    </sec:Security_Objectives_Rationale>
  </sec:Security_Objectives>
  <sec:Security_Requirements>
    <base-pp id="ND" version="4.0" name="Network Device" product="Network Device" short="ND">
      <url>https://www.niap-ccevs.org/protectionprofiles/482</url>
  	  <cPP/>

      <sec-func-req-dir>
      In a PP-Configuration that includes the NDcPP, the TOE is expected to rely on some of the security functions implemented 
      by the Network Device as a whole and evaluated against the NDcPP. The following sections describe any modifications that 
      the ST author must make to the SFRs defined in the NDcPP in addition to what is mandated by Section 5.2.
      </sec-func-req-dir>
      <modified-sfrs>
        <!-- 5.1.1.1  -->
        <section title="Cryptographic Support (FCS)" id="nd-m-fcs">
         
          <base-sfr-spec cc-id="fcs_cop.1" iteration="AEAD" id="nd-fcs-cop-1-aead" title="Cryptographic Operation - Authenticated Encryption with Associated Data">
            <consistency-rationale>This PP-Module modifies the Base-PP's definition of the SFR by mandating certain selections be chosen in it.</consistency-rationale>
            <description>
              <h:p>This SFR has been modified frmo its definition in the NDcPP to mandate selection of AES-CBC mode and 256-bit key sizes. Other selections may still be made if they are needed for other part of the TSF.</h:p>
              <h:p>The text of the requirement is replaced with:</h:p>
              <h:p>
              The TSF shall perform [authenticated encryption with associated data] in accordance with a specified cryptographic algorithm [<h:b>selection:</h:b> <h:i>Cryptographic algorithm</h:i>] and cryptographic key sizes [<h:b>selection:</h:b> <h:i>Cryptographic key sizes</h:i>] that meet the following: [<h:b>selection:</h:b> <h:i>List of standards</h:i>]
              </h:p><h:p>
              The following table provides the allowable choices for completion of the selection operations of FCS_COP.1/AEAD. In the last column, an X indicates it is mandatory for the ST author to include this row, and an O indicates that the row is optional and need not be included in the table if the TSF does not perform that function. Note that it is not necessary for the ST author to reproduce this final column in the table that does into the ST.
              </h:p>
              <h:b>Allowable choices for FCS_COP.1/AEAD</h:b><h:br/>
              <h:table>
                <h:tr>
                  <h:th>Identifier</h:th>
                  <h:th>Cryptographic algorithm</h:th>
                  <h:th>Cryptographic Key Sizes</h:th>
                  <h:th>List of standards</h:th>
                  <h:th>Mandatory or Optional</h:th>
                </h:tr>
                <h:tr>
                  <h:td>AES-CCM</h:td>
                  <h:td>AES in CCM mode with unpredictable, non-repeating nonce, minimum size of 64 bits</h:td>
                  <h:td>256 bits</h:td>
                  <h:td><h:p>[<h:b>selection:</h:b> <h:i>ISO/IEC 18033-3:2010 (Subclause 5.2), FIPS PUB 197</h:i>] [AES]</h:p><h:p>
                    [<h:b>selection:</h:b> <h:i>ISO/IEC 19772:2020 (Clause 7), NIST SP 800-38C</h:i>] [CCM]</h:p></h:td>
                  <h:td>X</h:td>
                </h:tr>
                <h:tr>
                  <h:td>AES-GCM</h:td>
                  <h:td>AES in GCM mode with non-repeating IVs using [<h:b>selection:</h:b> <h:i>deterministic, RBG-based</h:i>], IV construction; the tag must be of length [<h:b>selection:</h:b> <h:i>96, 104, 112, 120, 128</h:i>] bits.</h:td>
                  <h:td>256 bits</h:td>
                  <h:td><h:p>[<h:b>selection:</h:b> <h:i>ISO/IEC 18033-3:2010 (Subclause 5.2), FIPS PUB 197</h:i>] [AES]</h:p><h:p>
                    [<h:b>selection:</h:b> <h:i>ISO/IEC 19772:2020 (Clause 10), NIST SP 800-38D</h:i>] [GCM]</h:p></h:td>
                  <h:td>O</h:td>
                </h:tr>
              </h:table>
              </description>
            <no-change/>
          </base-sfr-spec>
          
          <base-sfr-spec cc-id="fcs_cop.1" iteration="DataEncryption" id="nd-fcs-cop-1-dataencryption" title="Cryptographic Operation (AES Data Encryption/Decryption)">
            <consistency-rationale>This PP-Module modifies the Base-PP's definition of the SFR by adding additional AES modes consistent with the standards referenced in the Base-PP and by mandating specific selections that are
            relevant to the technology type of the PP-Module.</consistency-rationale>
            <description>
              <h:p>This SFR has been modified from its definition in the NDcPP to mandate the 
              inclusion of CCM mode as defined in FCS_COP.1/AEAD.</h:p>
              <h:p>The text of the requirement is replaced with:</h:p>
              <h:p>
              The TSF shall perform encryption/decryption in accordance with a
              specified cryptographic algorithm AES operating in <h:b>CCM mode as defined in
                FCS_COP.1/AEAD and</h:b> [selection:<h:i><h:ul>                  
                  <h:li>CBC mode as defined in FCS_COP.1/SKC</h:li>                  
                  <h:li>CTR mode as defined in FCS_COP.1/SKC</h:li>
                  <h:li>XTS mode as defined in FCS_COP.1/SKC</h:li>
                  <h:li>GCM mode as defined in FCS_COP.1/AEAD</h:li>
                  </h:ul></h:i>].
              </h:p>
              <h:p><h:b>Application Note:</h:b>
                This requirement is modified from its definition in the NDcPP by mandating the selection of CCM mode in support of AES-CCMP as defined in IEEE 802.11-2020.
                If the TOE supports AES-GCMP as defined in IEEE 802.11ax-2021, support for GCM mode is also selected. Other AES modes are selectable if needed by another 
                part of the TSF (e.g., CBC mode would need to be supported if the TOE provides VPN gateway functionality and supports AES-CBC for ESP) but are not required 
                specifically for conformance to this PP-module. A selection for 'no other modes' has not been added as it is expected that a conformant TOE will require the use of at least one of CBC, CTR, XTS, and GCM modes to function in its evaluated configuration.
              </h:p>
              
              <h:br/><h:br/>
              <h:p><h:b>Evaluation Activities:</h:b><h:br/>
              <h:b><h:i>TSS</h:i></h:b><h:br/>There are no additional TSS evaluation activities for this component beyond what the NDcPP requires.<h:br/><h:br/>
              <h:b><h:i>Guidance</h:i></h:b><h:br/>There are no additional guidance evaluation activities for this component beyond what the NDcPP requires.<h:br/><h:br/>
              <h:b><h:i>Tests</h:i></h:b><h:br/>
                In addition to the tests required by the NDcPP, the evaluator will perform the following testing:
              <h:p><h:b>AES-CCM Tests</h:b></h:p>
              <h:p>The evaluator will test the generation-encryption and decryption-verification functionality of AES-CCM for the following input parameter and tag lengths:</h:p>
              <h:p><h:b>128 bit and 256 bit keys</h:b></h:p>
              <h:p><h:b>Two payload lengths</h:b>. One payload length will be the shortest supported payload length,
                greater than or equal to zero bytes. The other payload length will be the longest supported
                payload length, less than or equal to 32 bytes (256 bits).</h:p>
              <h:p><h:b>Two or three associated data lengths</h:b>.
                  One associated data length will be 0, if supported.
                  One associated data length will be the shortest supported payload length,
                  greater than or equal to zero bytes.
                  One associated data length will be the longest supported payload length, less than
                  or equal to 32 bytes (256 bits).
                  If the implementation supports an associated data length of 216
                  bytes, an associated data length of 216 bytes will be tested.
              </h:p>
              <h:p><h:b>Nonce lengths</h:b>.
                  All supported nonce lengths between 7 and 13 bytes, inclusive, will be tested.
              </h:p>
              <h:p><h:b>Tag lengths</h:b>.
                  All supported tag lengths of 4, 6, 8, 10, 12, 14, and 16 bytes will be tested.
              </h:p>
              <h:p>
                  Due to the restrictions that IEEE 802.11 specifies for this mode
                  (nonce length of 13 and tag length of 8),
                  it is acceptable to test a subset of the supported lengths as long as the selections
                  fall into the ranges specified above.
                  In this case, the evaluator will ensure that these are the only supported lengths.
                  To test the generation-encryption functionality of AES-CCM, the evaluator will
                  perform the following four tests:
              </h:p>
              <h:p>
                <h:ul>
                  <h:li>Test FCS_COP.1/DataEncryption:1: For each supported key and associated data length and any supported payload, nonce
                    and tag length, the evaluator will supply one key value, one nonce value and 10 pairs of
                    associated data and payload values, and obtain the resulting ciphertext.</h:li>
                  <h:li>Test FCS_COP.1/DataEncryption:2:For each supported key and payload length and any supported associated data, nonce
                    and tag length, the evaluator will supply one key value, one nonce value and 10 pairs of
                    associated data and payload values, and obtain the resulting ciphertext.</h:li>
                  <h:li>Test FCS_COP.1/DataEncryption:3: For each supported key and nonce length and any supported associated data, payload,
                    and tag length, the evaluator will supply one key value and 10 associated data, payload and
                    nonce value 3-tuples, and obtain the resulting ciphertext.</h:li>
                  <h:li>For each supported key and tag length and any supported associated data, payload, and
                    nonce length, the evaluator will supply one key value, one nonce value and 10 pairs of
                    associated data and payload values and, obtain the resulting ciphertext</h:li>
                </h:ul>
                To determine correctness in each of the above tests, the evaluator will compare the ciphertext with the
                result of generation-encryption of the same inputs with a known good implementation.</h:p>
              <h:p>
                To test the decryption-verification functionality of AES-CCM, for each combination of supported
                associated data length, payload length, nonce length, and tag length, the evaluator will supply a key
                value and 15 nonce, associated data and ciphertext 3-tuples, and obtain either a fail result or a pass
                result with the decrypted payload.
                The evaluator will supply 10 tuples that should fail and 5 that should pass per set of 15.
              </h:p>
              <h:p>
                Additionally, the evaluator will use tests from the IEEE 802.11-02/362r6 document “Proposed Test
                vectors for IEEE 802.11 TGi”, dated September 10, 2002, Section 2.1 AES-CCMP Encapsulation Example
                and Section 2.2 Additional AES-CCMP Test Vectors to verify further the IEEE 802.11-2020
                implementation of AES-CCMP.
              </h:p>
              </h:p>
            </description>

            <!-- NDcPP is not yet in XML format so there is no change that can be modeled -->
            <no-change/>
          </base-sfr-spec>
          
        </section>
        
        <section id="nd-m-ftp" title="Trusted Path/Channels (FTP)">
          <base-sfr-spec cc-id="ftp_itc.1" id="nd-m-ftp-itc-1" title="Inter-TSF Trusted Channel">
            <consistency-rationale>
            <comment>For CC:2022 updates, the modified audit events associated with this SFR have been removed. The modified audit events are not fundamentally different from those already defined in the Base-PP for the SFR 
            (both events would already fall into the category of 'Failure of the trusted channel functions', as detection of modification would cause an integrity error and failure of a trusted channel) and new PP syntax is incompatible with modified audit events. </comment>
            This PP-Module modifies the Base-PP's definition of the SFR by specifying a minimum baseline of required communications protocols and also includes additional protocols not originally
              defined by the Base-PP. The original protocols specified in the Base-PP may still be selected by the ST author.</consistency-rationale>
            <description>
            
            <h:p>This SFR has been modified from its definition in the Base-PP to mandate communications protocols that are necessary for a WLAN AS. Any element that
            is not mentioned in this section is unchanged from its definition in the Base-PP.</h:p>
            <h:p>The text of the requirement is replaced with: </h:p>
            <h:p><h:b>FTP_ITC.1.1: </h:b>The TSF shall be capable of using <h:b>IEEE 802.1X</h:b>, [<h:b>selection: </h:b><h:i>IPsec, <h:b>RADIUS over TLS</h:b></h:i>] <h:b>and</h:b>
            [<h:b>selection: </h:b><h:i>SSH, TLS, DTLS, HTTPS, <h:b>no other protocols</h:b></h:i>] to provide a trusted communication channel between itself and authorized
            IT entities supporting the following capabilities: <h:b>802.1X authentication server</h:b>, audit server, [<h:b>selection: </h:b><h:i>authentication server, 
            [<h:b>assignment: </h:b>other capabilities], no other capabilities</h:i>] that is logically distinct from other communication channels and provides assured
            identification of its end points and protection of the channel data from disclosure and detection of modification of the channel data.</h:p>
            <h:p><h:b>Application Note: </h:b>
            This requirement has been modified from its definition in the NDcPP to 
                  mandate the communications protocols and environmental components that 
                  a WLAN AS must use for infrastructure communications
                  (802.11 support is also required for wireless client communications, but this is covered
                  by the FTP_ITC.1/Client SFR in this PP-Module).
                  IPsec or RADIUS over TLS (commonly known as "RadSec") is required at least for communications with the 802.1X authentication server.
                  Other selections may be made if needed by other parts of the TSF.
                  The requirement implies that not only are communications protected when they are initially established,
                  but also on resumption after an outage.</h:p>
                <h:p>
                   The IT entity of "802.1X authentication server" is distinct from "authentication server"
                   because the latter may be used for administrator authentication rather 
                   than authorization of WLAN clients.
                </h:p><h:p>
                   If "IPsec" is selected in FTP_ITC.1.1, then FCS_IPSEC_EXT.1 from the NDcPP must be claimed.
                   If "RADIUS over TLS" is selected in FTP_ITC.1.1,
                   then FCS_RADSEC_EXT.1 in this PP-Module must be claimed, as well as FCS_TLSC_EXT.1 from the <h:a href="https://www.niap-ccevs.org/protectionprofiles/465">Functional Package for TLS, version 2.0</h:a>.
                   SSH is defined in the <h:a href="https://www.niap-ccevs.org/protectionprofiles/515">Functional Package for SSH, version 2.0</h:a>.
            </h:p>
            </description>
            <!-- NDcPP is not yet in XML format so there is no change that can be modeled -->
            <insert-after>
              <xpath-specified xpath="*//cc:f-element[@id='ftp-itc-1']">
                <f-component cc-id="ftp_itc.1" name="Inter-TSF Trusted Channel">
                <consistency-rationale>This PP-Module modifies the Base-PP's definition of the SFR by specifying a minimum baseline of required communications protocols and also includes additional protocols not originally
                  defined by the Base-PP. The original protocols specified in the Base-PP may still be selected by the ST author.</consistency-rationale>
                <f-element>
                  <title>The TSF shall be capable of using <h:b>IEEE 802.1X, <selectables>
                    <selectable id="s-ipsec">IPsec</selectable>
                    <selectable id="s-radius">RADIUS over TLS</selectable>
                  </selectables>, and</h:b> <selectables>
                      <selectable>SSH</selectable>
                      <selectable>TLS</selectable>
                      <selectable>DTLS</selectable>
                      <selectable>HTTPS</selectable>
                      <selectable exclusive="yes"><h:b>no other protocols</h:b></selectable>
                    </selectables> to provide a trusted communication channel
                    between itself and authorized IT entities supporting the following capabilities: <h:b>802.1X authentication server,</h:b> audit
                    server, <selectables>
                      <selectable>authentication server</selectable>
                      <selectable><assignable>other capabilities</assignable></selectable>
                      <selectable exclusive="yes">no other capabilities</selectable>
                    </selectables> that is logically distinct
                    from other communication channels and provides assured identification of its end points and protection
                    of the channel data from disclosure and detection of modification of the channel data.
                  </title>
                  <note role="application">
                    <h:p>
                      This requirement has been modified from its definition in the NDcPP to 
                      mandate the communications protocols and environmental components that 
                      a WLAN AS must use for infrastructure communications
                      (802.11 support is also required for wireless client communications, but this is covered
                      by the FTP_ITC.1/Client).
                      IPsec or RADIUS over TLS (commonly known as "RadSec") is required at least for communications with the 802.1X authentication server.
                      Other selections may be made if needed by other parts of the TSF.
                      The requirement implies that not only are communications protected when they are initially established,
                      but also on resumption after an outage.</h:p>
                    <h:p>
                      The IT entity of "802.1X authentication server" is distinct from "authentication server"
                      because the latter may be used for administrator authentication rather 
                      than authorization of WLAN clients.
                    </h:p><h:p>
                      If <xref to="s-ipsec"/> is selected in FTP_ITC.1.1, then FCS_IPSEC_EXT.1 from the NDcPP must be claimed.
                      If <xref to="s-radius"/> is selected in FTP_ITC.1.1,
                      then FCS_RADSEC_EXT.1 in this PP-Module must be claimed, as well as FCS_TLSC_EXT.1 from the NDcPP.
                    </h:p>
                  </note>
                </f-element>
                </f-component>
              </xpath-specified>
            </insert-after>
          </base-sfr-spec>
        </section>
      </modified-sfrs>
      <additional-sfrs/>
      <con-toe> 
        When this PP-Module extends the NDcPP, the TOE type for the overall TOE is still a network device.
	This PP-Module just defines the TOE as a specific type of network device with functional capabilities
        distinct to that type. </con-toe>
      <con-sec-prob/>
      <con-obj/>
      <con-op-en/>

      
      <!-- <con-mod id="fcs_ckm.2/DISTRIB">.</con-mod> -->

    </base-pp>
    <man-sfrs>
      <section title="Auditable Events for Mandatory SFRs" id="sec-audit-mandatory">
        <audit-table id="at-mandatory" table="mandatory"/>
      
      </section>
      
      <sec:man_fau title="Security Audit (FAU)">
        <f-component cc-id="fau_gen.1" name="Audit Data Generation" iteration="WLAN">
          <consistency-rationale>This SFR iterates the FAU_GEN.1 SFR defined in the Base-PP to define auditable events for the functionality that is specific to this PP-Module.</consistency-rationale>
<f-element>
            <title> The TSF shall be able to generate audit data of the following auditable
              events: <h:ol type="a">
                <h:li>Start-up and shutdown of the audit functions;</h:li>
                <h:li>All auditable events for the [<h:i>not specified</h:i>] level of audit; and</h:li>
                <h:li>[<h:i>Auditable events listed in the Auditable Events for Mandatory SFRs table (<xref to="at-mandatory"/>)</h:i>
                <h:br/><comment>The modified audit events for FCS_IPSEC_EXT.1 and FTP_ITC.1 have been omitted from the respective audit tables due 
                to a change in the syntax making it impossible to add an audit entry for an SFR that is not defined within the PP-Module itself. 
                The modifications made to these SFRs' audit events can likely be covered through application of the original audit events or modification to the NDcPP itself. 
                If this is insufficient, these SFRs may need to be converted to iterations instead of modified SFRs.</comment></h:li>
                <h:li><h:i>Failure of wireless sensor communication</h:i></h:li>]
              </h:ol>.
            </title>
	    <note role="application">
	      <h:p>
          The auditable events defined in <xref to="at-mandatory"/> and <xref to="at-sel-based"/> are for the SFRs that
          are explicitly defined in this PP-Module and are intended to extend FAU_GEN.1 in the Base-PP. The events in the Auditable Events table 
          should be combined with those of the NDcPP in the context of a conforming Security Target.
	      </h:p>
	      <h:p>
          If the ST includes any selection-based SFRs, the selection for "Auditable events listed in the Auditable Events for Selection-Based SFRs table" must be
          selected. If no selection-based SFRs are included, "no other events" should be selected. The Auditable Events for Selection-Based SFRs (<xref to="at-sel-based"/>)
          include audit records for selection-based SFRs. The auditing of selection-based SFRs is only required if that SFR is included in the ST.
	      </h:p>
	      <h:p>
		
	      </h:p>
	      <h:p>
		Per FAU_STG.1 in the Base-PP, the TOE must support transfer of the audit data to an
		external IT entity using a trusted channel.
	      </h:p>
	    </note>
  
</f-element> 
<f-element>
<title>
  The TSF shall record within the audit data at least the following information:
  <h:ol type="a">
    <h:li>Date and time of the auditable event, type of event, subject identity (if applicable), and the
      outcome (success or failure) of the event;
    </h:li>
    <h:li>
      For each auditable event type, based on the auditable event definitions of the functional
      components included in the PP, PP-Module, functional package or ST, [<h:i> information
      specified in column three of the Auditable Events table in which the auditable event
      was defined</h:i>].
    </h:li>
  </h:ol>
</title>
<aactivity>
    <TSS> There are no TSS evaluation activities for this SFR.<h:br/><h:br/>
    </TSS>
    <Guidance> There are no operational guidance activities for this SFR.<h:br/><h:br/>
    </Guidance>
    <Tests>The evaluator will test the TOE’s ability to correctly generate audit records
      by having the TOE generate audit records in accordance with the evaluation activities
      associated with the functional requirements in this PP-Module. When verifying the
      test results, the evaluator will ensure the audit records generated during testing
      match the format specified in the administrative guide and that the fields in each
      audit record have the proper entries. <h:br/><h:br/>
      Note that the testing here can
      be accomplished in conjunction with the testing of the security mechanisms directly.
      </Tests>
  </aactivity>
</f-element>
      <audit-event/>
        </f-component>
      </sec:man_fau>
      
      <sec:man_fcs title="Cryptographic Support (FCS)">
        
        <!-- previously FCS_CKM.1(2). Covers key gen for both WPA2 and WPA3 -->
        <f-component name="Cryptographic Key Generation (Symmetric Keys for WPA2 Connections)" cc-id="fcs_ckm.1" iteration="WPA">
            <consistency-rationale>This SFR defines additional cryptographic functionality not defined in the Base-PP, but it implements this using the DRBG mechanism already defined in the Base-PP.</consistency-rationale>
          <f-element>
            <title>
            <comment>It's not clear how CNSA 1.0 requirements are applied (if at all) to 802.11 crypto. This comment also applies to FCS_CKM.2/GTK and FCS_CKM.2/PMK. No substantive changes have been made to these SFRs yet.</comment>
              The TSF shall generate <h:b>symmetric</h:b> cryptographic keys in accordance with a
              specified cryptographic key generation algorithm [<h:i>PRF-384 and <selectables>
                <selectable>PRF-512</selectable>
                <selectable>PRF-704</selectable>
                <selectable exclusive="yes">no other algorithm</selectable>
              </selectables></h:i>] and specified cryptographic key sizes [<h:i>256 bits and <selectables>
                <selectable>128 bits</selectable>
                <selectable>192 bits</selectable>
                <selectable exclusive="yes">no other key sizes</selectable>
              </selectables></h:i>] <h:b>using a Random Bit Generator as specified in FCS_RBG.1</h:b> that meet the following: 
              [<h:i>IEEE 802.11-2020 and <selectables>
                <selectable>IEEE 802.11ax-2021</selectable>
                <selectable exclusive="yes">no other standards</selectable>
              </selectables></h:i>].
            </title>
            <note role="application">
	      <h:p>
		The cryptographic key derivation algorithm required by IEEE 802.11-2020 (Section
		12.7.1.2) and verified in WPA2 certification is PRF-384, which uses the HMAC-SHA-1 function and
		outputs 384 bits.
		The use of GCMP is defined in IEEE 802.11ax-2021 (Section 12.5.5) and
		requires a
		Key Derivation Function (KDF) based on HMAC-SHA-256 (for 128-bit symmetric keys) or HMAC-SHA-384 (for 256-bit symmetric keys).
		This KDF outputs 704 bits.
	      </h:p>
	      <h:p>
		This requirement applies only to the keys that are generated or derived for the communications
		between the AP and the client once the client has been authenticated.
		It refers to the derivation of the Group Temporal Key (GTK),
		through the Random Bit Generator (RBG) specified in this PP-Module,
		as well as the derivation of the Pairwise Transient Key (PTK) from the Pairwise Master Key (PMK),
		which is done using a random value generated by the RBG specified in this PP-Module,
		the HMAC function as specified in this PP-Module, as well as other information.
		This is specified in IEEE 802.11-2020, primarily in chapter 12.
		<no-link>FCS_RBG.1</no-link> is defined in the NDcPP.
	      </h:p>
            </note>
            <aactivity>
              <TSS>
		  The cryptographic primitives will be verified through evaluation activities specified elsewhere in this PP-Module.
                The evaluator will verify that the TSS describes how the primitives defined and implemented by this PP-Module
                are used by the TOE in establishing and maintaining secure connectivity to the wireless clients. This
                description will include how the GTK and PTK are generated or derived. The TSS will also provide a
                description of the developer’s methods of assuring that their implementation conforms to the
                cryptographic standards; this includes not only testing done by the developing organization, but also
                proof of third-party testing that is performed (e.g. WPA2 certification). The evaluator will ensure that
                the description of the testing methodology is of sufficient detail to determine the extent to which the
                details of the protocol specifics are tested.<h:br/><h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>
		  The evaluator will perform the following test using a packet sniffing tool to collect
		  frames between the TOE and a wireless client:
		<h:p>
                  Step 1: The evaluator will configure the AP to an unused channel and configure the WLAN
                  sniffer to sniff only on that channel (i.e., lock the sniffer on the selected channel).
		  The sniffer should also be configured to filter on the MAC address of the TOE and client.
		</h:p>
		<h:p>
                  Step 2: The evaluator will configure the TOE to communicate with a WLAN client using IEEE 
                  802.11-2020 and a 256-bit (64 hex values 0-f) pre-shared key,
		  setting up the connections as described in the operational guidance.
		  The pre-shared key is only used for testing.
		</h:p>
		<h:p>
                  Step 3: The evaluator will start the sniffing tool, initiate a connection between the
		  TOE and WLAN client, and allow the TOE to authenticate, associate, and successfully
		  complete the four-way handshake with the client.
		</h:p>
		<h:p>
                  Step 4: The evaluator will set a timer for one minute, at the end of which the evaluator
		  will disconnect the client from the TOE and stop the sniffer.
		</h:p>
		<h:p>
                  Step 5: The evaluator will identify the four-way handshake frames (denoted EAPOL-key in Wireshark
                  captures) and derive the PTK from the four-way handshake frames and pre-shared key as specified
		  in IEEE 802.11-2020.
		</h:p>
		<h:p>
                  Step 6: The evaluator will select the first data frame from the captured packets that was
		  sent between the client and TOE after the four-way handshake successfully completed
		  and without the frame control value 0x4208 (the first two bytes are 08 42).
		  The evaluator will use the PTK to decrypt the data portion of the packet as specified in
		  IEEE 802.11-2020 and verify that the decrypted data contains ASCII-readable text.
		</h:p>
		<h:p>
                  Step 7: The evaluator will repeat Step 6 for the next two data frames between the TOE and client,
		  and without frame control value 0x4208.
		</h:p>
		<h:p>
                  Additionally, the evaluator will test the PRF function using the test vectors from:
		  <h:ul>
                  <h:li>Section 2.4 “The PRF Function – PRF (key, prefix, data, length)” of the IEEE 802.11-02/362r6 document "Proposed Test vectors for IEEE 802.11 TGi" dated September 10, 2002</h:li>
                  <h:li>Annex J.3 “PRF reference implementation and test vectors” of IEEE 802.11-2020</h:li>
                  </h:ul>
		</h:p>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        
        <!-- previously FCS_CKM.2(3) -->
        <f-component name="Cryptographic Key Distribution (GTK)" cc-id="fcs_ckm.2" iteration="GTK">
          <consistency-rationale>This SFR defines additional cryptographic functionality not defined in the Base-PP that is used for functionality outside the original scope of the Base-PP.</consistency-rationale>
          <f-element>
            <title>
              The TSF shall distribute <h:b>Group Temporal Key (GTK)</h:b> in accordance with a specified cryptographic key distribution method: <selectables>
                <selectable>AES Key Wrap in an EAPOL-Key frame</selectable>
                <selectable>AES Key Wrap with Padding in an EAPOL-Key frame</selectable>
              </selectables> that meets the following: [<h:i>NIST SP 800-38F, IEEE 802.11-2020 for the packet format and timing considerations</h:i>] <h:b>
                and does not expose the cryptographic keys</h:b>. 
            </title>
            <note role="application">This requirement applies to the Group Temporal Key (GTK) that is generated by the
              TOE for use in broadcast and multicast messages to clients to which it is connected. 802.11-2020
              specifies the format for the transfer as well as the fact that it must be wrapped by the AES Key Wrap
              method specified in NIST SP 800-38F.</note>
            <aactivity>
              <TSS>The evaluator will check the TSS to ensure that it describes how the GTK is wrapped prior to being
                distributed using the AES implementation specified in this PP-Module, and also how the GTKs are distributed
                when multiple clients connect to the TOE.<h:br/><h:br/></TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>
		  The evaluator will perform the following test using a packet sniffing tool to collect frames
		  between a wireless client and the TOE (which may be performed in conjunction with the
		  evaluation activity for FCS_CKM.1/PMK.
		<h:p>
                  To fully test the broadcast and multicast functionality, these steps will be performed as
		  the evaluator connects multiple clients to the TOE.
		  The evaluator will ensure that GTKs established are sent to the
		  appropriate participating clients.
		</h:p>
		<h:p>
                  Step 1: The evaluator will configure the AP to an unused channel and configure the WLAN
                  sniffer to sniff only on that channel (i.e., lock the sniffer on the selected channel).
		  The sniffer should also be configured to filter on the MAC address of the TOE and client.
		</h:p>
		<h:p>
                  Step 2: The evaluator will configure the TOE to communicate with the client using
		  IEEE 802.11-2020 and a 256-bit (64 hex values 0-f) pre-shared key, setting up the
		  connections as described in the operational guidance.
		  The pre-shared key is only used for testing.
		</h:p>
		<h:p>
                  Step 3: The evaluator will start the sniffing tool, initiate a connection between the
		  TOE and client, and allow the client to authenticate, associate and successfully complete
		  the four-way handshake with the TOE.
		</h:p>
		<h:p>
                  Step 4: The evaluator will set a timer for one minute, at the end of which the evaluator
		  will disconnect the TOE from the client and stop the sniffer.
		</h:p>
		<h:p>
                  Step 5: The evaluator will identify the four-way handshake frames
		  (denoted EAPOL-key in Wireshark captures) and derive the PTK and GTK from the
		  four-way handshake frames and pre-shared key as specified in IEEE 802.11-2020.
		</h:p>
		<h:p>
                  Step 6: The evaluator will select the first data frame from the captured packets that was sent between
                  the TOE and client after the four-way handshake successfully completed,
		  and with the frame control value  0x4208 (the first two bytes are 08 42).
		  The evaluator will use the GTK to decrypt the data portion of the
                  selected packet as specified in IEEE 802.11-2020 and verify that the decrypted
		  data contains ASCII-readable text.
		</h:p>
		<h:p>
                  Step 7: The evaluator will repeat Step 6 for the next two data frames with frame control value 0x4208.
		</h:p>
		<h:p>
                  The evaluator will also perform the following testing based on the supported GTK distribution
		  methods:
		</h:p>
		<h:p><h:b>AES Key Wrap (AES-KW Tests)</h:b></h:p>
		<h:p>
                  <testlist>
                    <test>The evaluator will test the authenticated encryption functionality of AES-KW for each combination of the following input parameter lengths:
		    <h:ul>
		      <h:li>128 and 256 bit key encryption keys (KEKs)</h:li>
		    <h:li>
                      Three plaintext lengths:
		      <h:ol>
			<h:li>One of the plaintext lengths will be two semi-blocks (128 bits).</h:li>
			<h:li>One of the plaintext lengths will be three semi-blocks (192 bits).</h:li>
			<h:li>The third data unit length will be the longest supported plaintext
		      length less than or equal to 64 semi-blocks (4096 bits).</h:li>
		      </h:ol>
		    </h:li>
		    </h:ul>		    
                    For each combination, generate a set of 100 key and plaintext pairs
		    and obtain the ciphertext that results from AES-KW authenticated encryption. 
                    To determine correctness, the evaluator will use the same key and plaintext values
		    and encrypt them using a known good implementation of AES-KW authenticated-encryption,
		    and ensure that the resulting respective ciphertext values are identical.
		    </test>
                    <test>
		      The evaluator will test the authenticated-decryption functionality of AES-KW using
		      the same test as for authenticated-encryption, 
                      replacing plaintext values with ciphertext values and AES-KW authenticated-encryption with
		      AES-KW authenticated-decryption. 
                      Additionally, the evaluator will modify one byte of the ciphertext,
		      attempt to decrypt the modified ciphertext, and ensure that a failure is returned
		      rather than plaintext.
		    </test>
                  </testlist>
		</h:p>
		<h:p> <h:b>AES Key Wrap with Padding (AES-KWP Tests)</h:b></h:p>
		<h:p>
                <testlist>
                  <test>
		  <h:p>The evaluator will test the authenticated-encryption functionality of AES-KWP for each combination of the following input parameter lengths:</h:p>
		  <h:p>128 and 256 bit key encryption keys (KEKs)</h:p>
		    <h:p>
                      Three plaintext lengths. One plaintext length will be one octet. 
                      One plaintext length will be 20 octets (160 bits). 
                      One plaintext length will be the longest supported plaintext length less than or equal to 512 octets (4096 bits).
		    </h:p>
		    <h:p>
                      using a set of 100 key and plaintext pairs and obtain the ciphertext that results from AES-KWP authenticated encryption. 
                      To determine correctness, the evaluator will use the AES-KWP authenticated-encryption function of a known good implementation.
		    </h:p>
		  </test>
                  <test>
		    The evaluator will test the authenticated-decryption functionality of AES-KWP
		    using the same test as for AES-KWP authenticated-encryption, 
                    replacing plaintext values with ciphertext values and AES-KWP authenticated-encryption
		    with AES-KWP authenticated-decryption. 
                    Additionally, the evaluator will modify one byte of the ciphertext, attempt to decrypt the modified ciphertext, and ensure that a failure is returned rather than plaintext.
		  </test>
                </testlist>
		</h:p>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        
        
        <!-- previously FCS_CKM.2(2) -->
        <f-component name="Cryptographic Key Distribution (PMK)" cc-id="fcs_ckm.2" iteration="PMK">
          <consistency-rationale>This SFR defines additional cryptographic functionality not defined in the Base-PP that is used for functionality outside the original scope of the Base-PP.</consistency-rationale>
          <f-element>
            <title>
              The TSF shall <h:b>receive the 802.11 Pairwise Master Key (PMK)</h:b> in
              accordance with a specified cryptographic key distribution method: [<h:i>from 802.1X Authorization Server</h:i>]
              that meets the following: [<h:i>IEEE 802.11-2020</h:i>] <h:b>and does not expose the cryptographic keys</h:b>.
            </title>
            <note role="application">
              This requirement applies to the Pairwise Master Key that is received from the RADIUS
              server by the TOE. The intent of this requirement is to ensure conformant TOEs implement 802.1X
              authentication prior to establishing secure communications with the client.
              The intent is that any WLAN AS evaluated against this PP-Module will support both
              WPA2-Enterprise and WPA3-Enterprise at a minimum and certificate-based authentication mechanisms
              and therefore disallows implementations that support only pre-shared keys. Because communications
              with the RADIUS server are required to be performed over a protected connection, the transfer
              of the PMK will be protected.
            </note>
            <aactivity>
              <TSS>The evaluator will examine the TSS to determine that it describes how the PMK is transferred (that is,
                through what EAP attribute) to the TOE.<h:br/><h:br/></TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>The evaluator will establish a session between the TOE and a RADIUS server according to the
              configuration guidance provided.
	      The evaluator will then examine the traffic that passes between the
              RADIUS server and the TOE during a successful attempt to connect a wireless client to the TOE to
              determine that the PMK is not exposed.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        
      </sec:man_fcs>
      
      
      <sec:man_fia title="Identification and Authentication (FIA)">
      <!-- FIA_AFL.1 no longer needed, removed -->
        
        
        
        <ext-comp-def title="802.1X Port Access Entity (Authenticator) Authentication" fam-id="FIA_8021X_EXT">
          <fam-behavior>Components in this family describe requirements for implementation of 802.1X port-based network access control.</fam-behavior> 
        </ext-comp-def>   
        
        <f-component name="802.1X Port Access Entity (Authenticator) Authentication" cc-id="fia_8021x_ext.1">
          
          <consistency-rationale>This SFR defines support for 802.1X communications, which is a logical interface that extends the scope of what the Base-PP originally defined.</consistency-rationale>
          
          <comp-lev>requires the TSF to securely implement IEEE 802.1X as an authenticator.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>The following actions should be auditable if FAU_GEN Security Audit Data Generation is included in the ST: <h:ul>
              <h:li>Attempts to access the 802.1X controlled port prior to successful completion of the authentication exchange</h:li>
            </h:ul>
          </audit>
          <dependencies>No dependencies</dependencies>
          
          <f-element><title>The TSF shall conform to IEEE Standard 802.1X for a Port Access Entity (PAE) in the
            “Authenticator” role.</title></f-element>
          <f-element><title>The TSF shall support communications to a RADIUS authentication server
            conforming to RFCs 2865 and 3579.</title></f-element>
          <f-element><title>The TSF shall ensure that no access to its 802.1X controlled port is given to the
            wireless client prior to successful completion of this authentication exchange.</title>
            <note role="application">
	      <h:p>
            This requirement covers the TOE's role as the authenticator in an 802.1X
            authentication exchange. If the exchange is completed successfully, the TOE will obtain the PMK from
            the RADIUS server and perform the four-way handshake with the wireless client (supplicant) to begin
            802.11 communications.</h:p>
	    <h:p>
            As indicated previously, there are at least three communication paths present during the exchange; two
            with the TOE as an endpoint and one with the TOE acting as a transfer point only.
	    The TOE establishes an EAP over Local Area Network (EAPOL) connection with the wireless
	    client as specified in 802.1X-2007.
	    The TOE also establishes (or has established) a RADIUS protocol connection protected either
	    by IPsec or RadSec (TLS) with the RADIUS server. 
            The wireless client and RADIUS server establish an EAP-TLS session
            (RFC 5216); in this transaction the TOE merely takes the EAP-TLS packets from its EAPOL/RADIUS
            endpoint and transfers them to the other endpoint. Because the specific authentication method (TLS in
            this case) is opaque to the TOE, there are no requirements with respect to RFC 5126 in this PP-Module.
            However, the base RADIUS protocol (2865) has an update (3579) that will need to be addressed in the
            implementation and evaluation activities. Additionally, RFC 5080 contains implementation issues that
            will need to be addressed by developers but which levy no new requirements.</h:p>
	    <h:p>
            
            The point of performing 802.1X authentication is to provide access to the network (assuming the
            authentication was successful and that all 802.11 negotiations are performed successfully); in the
            terminology of 802.1X, this means the wireless client has access to the "controlled port" maintained by
            the TOE.
	    </h:p>
      <h:p>TLS is defined in the <xref to="pkgTLS"/>.</h:p>
          </note>
            <aactivity>
              <TSS>
                In order to show that the TSF implements the 802.1X-2010 standard correctly, the evaluator will ensure
                that the TSS contains the following information: <h:ul>
                <h:li>The sections (clauses) of the standard that the TOE implements</h:li>
                <h:li>For each identified section, any options selected in the implementation allowed by the
                standards are specified</h:li>
                <h:li>For each identified section, any non-conformance is identified and described, including a
                justification for the non-conformance</h:li>
                </h:ul>
                Because the connection to the RADIUS server will be contained in an IPsec or RadSec (TLS) tunnel,
                the security mechanisms detailed in the RFCs identified in the requirement are not relied on to provide
                protection for these communications. Consequently, no extensive analysis of the RFCs is required.
                However, the evaluator will ensure that the TSS describes the measures (documentation, testing) that
                are taken by the product developer to ensure that the TOE conforms to the RFCs listed in this
                requirement.<h:br/><h:br/>
              </TSS>
              <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
              <Tests>
                The evaluator will perform the following tests:
                <testlist>
                  <test>The evaluator will demonstrate that a wireless client has no access to the test network. After
                    successfully authenticating with a RADIUS server through the TOE, the evaluator will demonstrate that
                    the wireless client does have access to the test network.</test>
                  <test>The evaluator will demonstrate that a wireless client has no access to the test network. The
                    evaluator will attempt to authenticate using an invalid client certificate, such that the EAP-TLS
                    negotiation fails. This should result in the wireless client still being unable to access the test network.
                  </test>
                  <test>The evaluator will demonstrate that a wireless client has no access to the test network. The
                    evaluator will attempt to authenticate using an invalid RADIUS certificate, such that the EAP-TLS
                    negotiation fails. This should result in the wireless client still being unable to access the test network.</test>
                </testlist>
                <h:b>Note: </h:b>Tests 2 and 3 above are not tests that "EAP-TLS works," although that is a by-product of the test.
                The test is actually that a failed authentication (under two failure modes) results in denial of access to
                the network, which demonstrates the enforcement of FIA_8021X_EXT.1.3.
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Attempts to access the 802.1X controlled port prior to successful completion of the authentication exchange.</audit-event-descr>
            <audit-event-info>Provided client identity (e.g. Media Access Control [Media Access Control (MAC)] address).</audit-event-info>
          </audit-event>
          <audit-event>
            <audit-event-descr>Failed authentication attempt.</audit-event-descr>
            <audit-event-info>Provided client identity (e.g. MAC address).</audit-event-info>
          </audit-event>
        </f-component>
      
    
      <f-component name="Re-Authenticating" cc-id="fia_uau.6">
        <consistency-rationale>This SFR defines support for re-authentication of wireless users, which are a type of subject beyond the scope of what the Base-PP originally defined.</consistency-rationale>
        <f-element>
          <title>The TSF shall re-authenticate the <h:b>administrative</h:b> user under the conditions [<h:i>when the user
            changes their password, <selectables>
              <selectable>following TSF-initiated session locking</selectable>
              <selectable><assignable>other conditions</assignable></selectable>
              <selectable exclusive="yes">no other conditions</selectable>
            </selectables></h:i>]. 
          </title>
          <aactivity>
            <TSS>There are no TSS evaluation activities for this component.<h:br/><h:br/></TSS>
            <Guidance>There are no guidance evaluation activities for this component.<h:br/><h:br/></Guidance>
            <Tests>
	      The evaluator will attempt to change their password as directed by the operational guidance.
              While making this attempt, the evaluator will verify that re-authentication is required.
	      <h:p>
		If other re-authentication conditions are specified, the evaluator will cause those conditions to
		occur and verify that the TSF re-authenticates the authenticated user.
	      </h:p>
            </Tests>
          </aactivity>
        </f-element>
        <audit-event>
          <audit-event-descr>Attempts to re-authenticate.</audit-event-descr>
          <audit-event-info>Origin of the attempt (e.g., IP address).</audit-event-info>
        </audit-event>
      </f-component>
      </sec:man_fia>
      
      <sec:man_fmt title="Security Management (FMT)">
        <f-component name="Specification of Management Functions (WLAN Access Systems)" id="fel-managementfun-as" cc-id="fmt_smf.1" iteration="AccessSystem">
			<consistency-rationale>This SFR defines additional management functionality that is specific to the Module’s product type and would therefore not be expected to be present in the Base-PP.</consistency-rationale>
			<f-element>
			<title>The TSF shall be capable of performing the following management functions: 
			  [<h:ul>
			    <h:li><h:i>Configure the security policy for each wireless network, including:</h:i></h:li>
			    <h:ul> 
			      <h:li><h:i>Security type</h:i></h:li>
			      <h:li><h:i>Authentication protocol</h:i></h:li>
			      <h:li><h:i>Client credentials to be used for authentication</h:i></h:li>
			      <h:li><h:i>SSID</h:i></h:li>
			      <h:li><h:i>If the SSID is broadcasted</h:i></h:li>
			      <h:li><h:i>Frequency band set to <selectables><selectable>2.4 GHz</selectable><selectable>5 GHz</selectable><selectable>6 GHz</selectable></selectables></h:i></h:li>
			      <h:li><h:i>Transmit power level</h:i></h:li>
			    </h:ul></h:ul>]</title>
			<aactivity>
			  <TSS>
			    The evaluator will confirm that the TSS includes which security types (e.g., WPA3),
			    authentication protocol (e.g., SAE), and frequency bands the WLAN AS supports.
			    The evaluator will confirm that the TSS includes how connection attempts
			    from clients that are not operating on an approved security type are handled.<h:br/><h:br/>
			  </TSS>
			  <Guidance> 
			    The evaluator will confirm that the operational guidance includes instructions for configuring the WLAN AS 
				  for each feature listed.<h:br/><h:br/>
			  </Guidance>
			  <Tests>
			  <testlist>
			    <test>For each security type specified in the TSS, configure the network to the approved security type and verify that the client can establish a connection.  Maintaining the same SSID, change the security type of the client to a non-approved security type and attempt to establish a connection.  Verify that the connection was unsuccessful. </test>
			    <test>For each authentication protocol specified in the TSS, configure the network accordingly per the AGD. Verify that the client connection attempt is successful when using the correct client credentials and that the connection is unsuccessful when incorrect authentication credentials are used. </test>		  
			    <test>
			      Configure the SSID to be broadcasted.
			      Using a network sniffing tool, capture a beacon frame and confirm that the SSID is included.
			      Configure the SSID to be hidden.
			      Using a network sniffing tool, capture a beacon frame and confirm that the SSID is not listed.
			    </test>		  
			    <test>The evaluator will configure the AS to operate in each of the selected frequency bands and verify using a network sniffing tool. </test>	
			    <test>The evaluator will demonstrate that the client can establish a connection to the AS on the default power level.  After disconnecting,  the power level should be adjusted and then the client should be able to successfully connect to the AS again.</test>
			  </testlist>
			  </Tests>
			</aactivity>
		</f-element>
    <audit-event/>
		</f-component>
        <ext-comp-def title="Security Management Restrictions" fam-id="FMT_SMR_EXT">
          <fam-behavior>Components in this family describe architectural restrictions on security administration that are not defined in CC Part 2.</fam-behavior> 
        </ext-comp-def>
    <f-component name="No Administration from Client" cc-id="fmt_smr_ext.1">
          <consistency-rationale>This SFR applies restrictions on when the execution of management functions is authorized. It does not prevent proper administration of the TSF.</consistency-rationale>
          
          <comp-lev>requires the TSF to reject remote administration from a wireless client by default.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FMT_SMF.1 Specification of Management Functions</dependencies>
          
          <f-element>
            <title>
              The TSF shall ensure that the ability to administer remotely the TOE from a wireless client
              shall be disabled by default.
            </title>
            <aactivity>
              <TSS>There are no TSS evaluation activities for this component.<h:br/><h:br/></TSS>
              
              <Guidance>The evaluator will review the operational guidance to ensure that it contains instructions for
                administering the TOE both locally and remotely, including any configuration that needs to be
                performed on the client for remote administration. The evaluator will confirm that the TOE
                does not permit remote administration from a wireless client by default.<h:br/><h:br/></Guidance>
              
              <Tests>The evaluator will demonstrate that after configuring the TOE for first use from the operational
                guidance, it is possible to establish an administrative session with the TOE on the “wired” portion of the
                device. They will then demonstrate that an identically configured wireless client that can successfully
                connect to the TOE cannot be used to perform administration.</Tests>
            </aactivity>
          </f-element>
        <audit-event/>
        </f-component>
      </sec:man_fmt>
      
      
      
      <sec:man_fta title="TOE Access (FTA)">
       
        <f-component name="TOE Session Establishment" cc-id="fta_tse.1">
          <consistency-rationale>This SFR applies restrictions on establishment of wireless communications, which is a logical interface that extends the scope of what the Base-PP originally defined.</consistency-rationale>
          <f-element>
            <title>The TSF shall be able to deny session establishment <h:b>of a wireless client session</h:b> based
              on [<h:i>TOE interface, time, day, <selectables>
                <selectable><assignable>other attributes</assignable></selectable>
                <selectable exclusive="yes">no other attributes</selectable>
              </selectables></h:i>].
            </title>
            <note role="application">
	      <h:p>
              The “TOE interface” can be specified in terms of the device in the TOE that the WLAN
              client is connecting to (e.g. specific WLAN APs). “Time” and “day” refer to time-of-day and
              day-of-week, respectively.
	      </h:p>
	      <h:p>
              The assignment is to be used by the ST author to specify additional attributes on which denial of session
              establishment can be based. In the case of standalone TOEs with a single interface, the "based on TOE interface"
              restriction is inherently met.
	      </h:p>
            </note>
            <aactivity>
              <TSS>
		The evaluator will examine the TSS to determine that all of the attributes on
		which a client session can be denied are specifically defined.<h:br/><h:br/></TSS>
              <Guidance>The evaluator will examine the operational guidance to determine that it contains guidance for
                configuring each of the attributes identified in the TSS.<h:br/><h:br/></Guidance>
              <Tests>
                For each supported attribute, the evaluator will perform the following test:
                <testlist>
                  <test>
		    The evaluator successfully establishes a client session with a wireless client.
		    The evaluator then follows the operational guidance to configure the system so
		    that the client’s access is denied based on a specific value of the attribute.
		    The evaluator will then attempt to establish a session in contravention
                    to the attribute setting (for instance, the client is denied WLAN access based upon the TOE interface
                    (e.g. WLAN AP) it is connecting to, or that the client is denied access based upon the time-of-day or
                    day-of-week it is attempting connection on).
		    The evaluator will observe that the access attempt fails.
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Denial of a session establishment due to the session establishment mechanism.</audit-event-descr>
            <audit-event-info>Reason for denial, origin of establishment attempt.</audit-event-info>
          </audit-event>
        </f-component>
      </sec:man_fta>
	  <sec:man_ftp title="Trusted Path/Channels (FTP)">
		  <f-component cc-id="ftp_itc.1" name="Inter-TSF Trusted Channel (WLAN Client Communications)" iteration="Client">
		  <consistency-rationale>
			  This SFR iterates the FTP_ITC.1 SFR defined in the Base-PP to define trusted communication channels for the functionality that is specific to this PP-Module.
			  </consistency-rationale>
			  <f-element>
			  <title>The TSF shall provide a communication channel <h:b>using WPA3-Enterprise, WPA2-Enterprise and <selectables>
		          <selectable>WPA3-SAE</selectable>
		          <selectable>WPA3-SAE-PK</selectable>
              <selectable>WPA2-PSK</selectable>
              <selectable exclusive="yes">no other modes</selectable></selectables> as defined by IEEE 802.11-2020</h:b>
		          
		          between itself and <h:b>WLAN clients</h:b> that is logically distinct from other communication channels and provides assured
		          identification of its end points and protection of the channel data from modification or
		          disclosure.
		          
		        </title>
				</f-element>
			    <f-element>
		<title>
			The TSF shall permit [<h:i>the authorized IT entities</h:i>] to initiate communication via the trusted channel.
		</title>
	</f-element>
			  <f-element>
			  <title>The TSF shall initiate communication via the trusted channel for [<h:i>no services</h:i>].</title>
				  <aactivity>

				    <no-tests>This component is adequately evaluated when performing the evaluation activities for <no-link>FTP_ITC.1</no-link> in the <xref to="ND"/> base-PP.</no-tests>
				  </aactivity>	  
			  </f-element>
        <audit-event/>
		  </f-component>
      </sec:man_ftp>
        
    </man-sfrs>
    <opt-sfrs>
      <section title="Auditable Events for Optional SFRs" id="sec-audit-optional">
        <audit-table id="at-optional" table="optional"/>
      </section>
      <sec:opt_fcs title="Cryptographic Support (FCS)">
        
       
        <f-component name="Cryptographic Key Distribution (802.11 Keys)" cc-id="fcs_ckm.2" iteration="DISTRIB">
          <consistency-rationale>This SFR defines an additional use for the cryptographic and self-protection mechanisms defined in the Base-PP.</consistency-rationale>
          <f-element>
            <title>The TSF shall distribute <h:b>the IEEE 802.11</h:b> keys in accordance with a
              specified cryptographic key distribution method [<h:i>trusted channel protocol specified in FPT_ITT.1 (Base-PP)</h:i>] that meets the following: [<h:i>standards specified in the various iterations of FCS_COP.1</h:i>] <h:b>and
                does not expose the cryptographic keys</h:b>.
            </title>
            <note role="application">
	      <h:p>
          This requirement applies to any key necessary for successful IEEE 802.11 connections
          not covered by FCS_CKM.2/GTK.
          In cases where a key must be distributed to other APs, this
          communication must be performed via a mechanism of commensurate cryptographic strength.
          Because communications with any component of a distributed TOE are required to be
          performed over a trusted connection, the transfer of these keys will be protected.
	      </h:p>
	      <h:p>
		FCS_COP.1 and FPT_ITT.1 are defined in the NDcPP.
	      </h:p>
	      </note>
            <aactivity>
              <TSS>The evaluator will examine the TSS to determine that it describes which keys are distributed outside
                the TOE, where they are sent, and the purpose for this transfer.<h:br/><h:br/></TSS>
              <Guidance>If this function is dependent on TOE configuration, the evaluator will confirm that the operational
              guidance contains instructions for how to configure that the keys are adequately protected.<h:br/><h:br/>
	      </Guidance>
              <Tests>This requirement will be tested in conjunction with the tests for the cryptographic primitives, the secure
                protocols, and FPT_ITT.1 (Base-PP).</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
      </sec:opt_fcs>   

    <!-- FPT_ITT.1 removed because it exists in the NDcPP now  -->

    </opt-sfrs>
    <sel-sfrs>

      <section title="Auditable Events for Selection-Based SFRs" id="sec-audit-sel-based">
        <audit-table id="at-sel-based" table="sel-based"/>
      </section>
      
      <sec:sel_fcs title="Cryptographic Support (FCS)">
        
        <ext-comp-def title="RadSec" fam-id="FCS_RADSEC_EXT">
          <fam-behavior>Components in this family describe requirements for implementation of the RadSec (RADIUS over TLS) protocol.</fam-behavior> 
        </ext-comp-def>
        <!-- added by TD0271 -->
        <f-component name="RadSec" cc-id="fcs_radsec_ext.1">
		  <depends on="s-radius"/>
          <consistency-rationale>This SFR defines the implementation of RadSec and the peer authentication method that it uses. 
            This relies on the TLS requirements defined by the Base-PP and may also use the X.509v3 certificate validation methods
            specified in the Base-PP, depending on the selected peer authentication method.</consistency-rationale>
          
          <comp-lev>requires the TSF to implement RadSec using a specified peer authentication method.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>
	    FCS_TLSC_EXT.1 TLS Client Protocol and<h:br/>
            [<no-link>FIA_PSK_EXT.1</no-link> Pre-Shared Key Composition<h:br/> or
            FIA_X509_EXT.1 X.509v3 Certificate Validation]
	  </dependencies>
          <f-element>
            <title>
              The TSF shall implement RADIUS over TLS as specified in RFC 6614 to communicate securely with a RADIUS server.
            </title>
          </f-element>
          <f-element>
            <title>
            The TSF shall perform peer authentication using <selectables>
              <selectable id="s-x509-certs">X.509v3 certificates</selectable>
              <selectable id="s-radsec-psk">pre-shared keys</selectable>
            </selectables>.
            </title>
			  <ext-comp-def-title><title>
              The TSF shall perform peer authentication using <assignable>some authentication method</assignable>.
              </title></ext-comp-def-title>
            <note role="application">
	      <h:p>This SFR is applicable if "RADIUS over TLS" is selected in FTP_ITC.1.1.</h:p>
	      <h:p>
		If <xref to="s-x509-certs"/> is selected in FCS_RADSEC_EXT.1.2,
		then FCS_TLSC_EXT.2 from the <xref to="pkgTLS"/> must be claimed. 
		If <xref to="s-radsec-psk"/> is selected in FCS_RADSEC_EXT.1.2, then FCS_RADSEC_EXT.2 and FIA_PSK_EXT.1 in this PP-Module must be claimed.
	      </h:p>
            </note>
            <aactivity>
              <TSS>
		  The evaluator will verify that the TSS description includes the use of
		  RADIUS over TLS, as described in RFC 6614.
		<h:p>
                  If X.509v3 certificates is selected, the evaluator will ensure that the TSS description includes the use of client-side certificates for TLS mutual authentication.
		</h:p>
	      </TSS>
              <Guidance>
		The evaluator will verify that any configuration necessary to meet the requirement must be contained in the guidance.<h:br/><h:br/>
	      </Guidance>
              <Tests>
		The evaluator will demonstrate the ability to successfully establish a RADIUS over TLS connection with a RADIUS server. 
                This test will be performed with X.509v3 certificates if selected and performed with pre-shared keys if selected.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        
        <!-- added by TD0271 -->
        <f-component name="RadSec using Pre-Shared Keys" cc-id="fcs_radsec_ext.2">
		  <depends on="s-radsec-psk"/>
          <consistency-rationale>This SFR defines the implementation of RadSec when pre-shared key authentication is used. This functionality is outside the original scope of the Base-PP, but it relies on 
            the TLS client protocol implementation, cryptographic algorithms, and random bit generation functions defined by the Base-PP.</consistency-rationale>
          
          <comp-lev>requires the TSF to implement RadSec using pre-shared key authentication in a manner that conforms to relevant TLS specifications.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>
	    FCS_CKM.1 Cryptographic Key Generation<h:br/>
            FCS_TLSC_EXT.1 TLS Client Protocol<h:br/>
            <no-link>FCS_RADSEC_EXT.1</no-link> RadSec<h:br/>
	  </dependencies>
          <f-element>
          
            <title> <comment>This SFR is a recreation of FCS_TLSC_EXT.1 as present in the NDcPP v2.2e with refinements and an additional element. It's unclear how this requirement should be handled moving forward as we move 
            these types of requirements into the TLS FP. The TLS FP v2.0 contains some of the PSK ciphersuites listed here but not all of them.</comment>
            The TSF shall implement <selectables>
              <selectable>TLS 1.2 (RFC 5246)</selectable>
              <selectable>TLS 1.1 (RFC 4346)</selectable>
            </selectables> and <h:b>no earlier</h:b> TLS and SSL versions when acting as a RADIUS over TLS client <h:b>that supports the following ciphersuites</h:b>: 
              <selectables linebreak="yes">
                <selectable>TLS_PSK_WITH_AES_128_CBC_SHA</selectable>
                <selectable>TLS_PSK_WITH_AES_256_CBC_SHA</selectable>
                <selectable>TLS_DHE_PSK_WITH_AES_128_CBC_SHA</selectable>
                <selectable>TLS_DHE_PSK_WITH_AES_256_CBC_SHA</selectable>
                <selectable id="s-rsa_psk_aes_128_cbc">TLS_RSA_PSK_WITH_AES_128_CBC_SHA</selectable>
                <selectable id="s-rsa_psk_aes_256_cbc">TLS_RSA_PSK_WITH_AES_256_CBC_SHA</selectable>
                <selectable>TLS_PSK_WITH_AES_128_GCM_SHA256</selectable>
                <selectable>TLS_PSK_WITH_AES_256_GCM_SHA384</selectable>
                <selectable>TLS_DHE_PSK_WITH_AES_128_GCM_SHA256</selectable>
                <selectable>TLS_DHE_PSK_WITH_AES_256_GCM_SHA384</selectable>
                <selectable id="s-rsa_psk_aes_128_gcm">TLS_RSA_PSK_WITH_AES_128_GCM_SHA256</selectable>
                <selectable id="s-rsa_psk_aes_256_gcm">TLS_RSA_PSK_WITH_AES_256_GCM_SHA384</selectable>
              </selectables>.
            </title>
            <ext-comp-def-title>
              <title>The TSF shall implement <assignable>list of allowed TLS versions</assignable> and reject all other TLS and SSL versions. 
                The TLS implementation shall support the following ciphersuites for use when acting as a RADIUS over TLS client: <assignable>list of supported ciphersuites</assignable>.</title>
            </ext-comp-def-title>
            <note role="application">
	      <h:p>
		If any of the TLS_RSA_PSK ciphersuites are selected by the ST author,
	        it is necessary to claim the selection-based requirement FCS_RADSEC_EXT.3.
	      </h:p>
	      <h:p>
		The above ciphersuites are only for use when the TSF is acting as a RADIUS over TLS client,
		not for other uses of the TLS protocol. 
		The ciphersuites to be tested in the evaluated configuration are limited by this requirement. 
		The ST author should select the ciphersuites that are supported.
		If "X.509v3 certificates" is selected in FCS_RADSEC_EXT.1.2, 
		the ciphersuites selected in (and tested by) FCS_TLSC_EXT.2.1 are also supported for
		RADIUS over TLS client use.
	      </h:p>
            </note>
          </f-element>
          <f-element>
            <title>The TSF shall be able to <selectables>
              <selectable>accept</selectable>
              <selectable>generate using the random bit generator specified in FCS_RBG.1</selectable>
            </selectables> bit-based pre-shared keys.</title>
            <aactivity>
              <TSS>
		The evaluator will check the description of the implementation of this protocol in the TSS to ensure that the ciphersuites supported are specified. 
                The evaluator will check the TSS to ensure that the ciphersuites specified are identical to those listed for this component. 
                The evaluator will also verify that the TSS contains a description of the denial of old SSL and TLS versions.
		<h:p>
                  The evaluator will examine the TSS to ensure it describes the process by which the bit-based pre-shared keys are generated (if the TOE supports this functionality) 
                  and confirm that this process uses the RBG specified in FCS_RBG.1.
		</h:p>
	      </TSS>
              <Guidance>
		The evaluator will verify that any configuration necessary to meet the requirement must be contained in the guidance.
		<h:p>
                  The evaluator will also check the guidance documentation to ensure that it contains instructions on configuring the TOE so that RADIUS over TLS conforms to the description in the TSS 
                  (for instance, the set of ciphersuites advertised by the TOE may have to be restricted to
		  meet the requirements).
		</h:p>
		<h:p>
                  The evaluator will confirm the operational guidance contains instructions for either entering bit-based pre-shared keys or generating a bit-based pre-shared key (or both).
		</h:p>
	      </Guidance>
              <Tests>The evaluator will perform the following tests:
              <testlist>
                <test>The evaluator will establish a RADIUS over TLS connection using each of the ciphersuites selected in FCS_RADSEC_EXT.2.1. 
                  It is sufficient to observe the successful negotiation of a cipher suite to satisfy the intent of the test; it is not necessary 
                  to examine the characteristics of the encrypted traffic in an attempt to discern the cipher suite being used (for example, 
                  that the cryptographic algorithm is 128-bit AES and not 256-bit AES).</test>
                <test>The evaluator will set the pre-shared key to a value that does not match the server's pre-shared key and demonstrate that the TOE cannot successfully complete a protocol negotiation using this key.</test>
                <test>The evaluator will configure the server to select the TLS_NULL_WITH_NULL_NULL cipher suite and verify that the client denies the connection.</test>
                <test>The evaluator will perform the following modifications to the traffic:<h:ul>
                  <h:li>Change the TLS version selected by the server in the Server Hello to a non-supported TLS version (for example, 1.3, represented by the two bytes 03 04) and verify that the client rejects the connection.</h:li>
                  <h:li>Modify at least one byte in the server’s nonce in the Server Hello handshake message, and verify that the client rejects the Server Key Exchange handshake message 
                    (if using a DHE cipher suite) or that the server denies the client’s Finished handshake message.</h:li>
                  <h:li>Modify the server’s selected cipher suite in the Server Hello handshake message to be a cipher suite not presented in the Client Hello handshake message. 
                    The evaluator will verify that the client rejects the connection after receiving the Server Hello.</h:li>
                  <h:li>Modify a byte in the Server Finished handshake message, and verify that the client rejects the connection and does not send any application data.</h:li>
                  <h:li>Send a garbled message from the server after the server has issued the ChangeCipherSpec message and verify that the client denies the connection.</h:li>
                </h:ul></test>
                <test>[conditional] If the TOE does not generate bit-based pre-shared keys, the evaluator will obtain a bit-based pre-shared key of the appropriate length and enter it according to the instructions in the operational guidance. 
                  The evaluator will then demonstrate that a successful protocol negotiation can be performed with the key.</test>
                <test>[conditional] If the TOE does generate bit-based pre-shared keys, the evaluator will generate a bit-based pre-shared key of the appropriate length and use it according to the instructions in the operational guidance. 
                  The evaluator will then demonstrate that a successful protocol negotiation can be performed with the key.</test>
              </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        
        
        <f-component name="RadSec using Pre-Shared Keys and RSA" cc-id="fcs_radsec_ext.3">
		  <depends on="s-rsa_psk_aes_128_cbc" on1="s-rsa_psk_aes_256_cbc" on2="s-rsa_psk_aes_128_gcm" on3="s-rsa_psk_aes_256_gcm"/>
          <consistency-rationale>This SFR defines the implementation of RadSec when pre-shared key authentication with RSA is used. This functionality is outside the original scope of the Base-PP, but it relies on 
            the TLS client protocol implementation, cryptographic algorithms, and random bit generation functions defined by the Base-PP.</consistency-rationale>
          
          <comp-lev>requires the TSF to validate the external entity used for trusted communications.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>
	    FCS_RADSEC_EXT.2 RadSec using Pre-Shared Keys<h:br/>
            <no-link>FIA_X509_EXT.1</no-link> X.509v3 Certificate Validation<h:br/>
          </dependencies>
          <f-element>
            <title>
              When the TSF negotiates a TLS_RSA_PSK cipher suite, the TSF shall verify that the presented identifier matches the reference identifier per RFC 6125 section 6.
            </title>
            <note role="application">
	      <h:p>
	      This requirement must be claimed if any ciphersuites beginning with 'TLS_RSA_PSK' are selected in FCS_RADSEC_EXT.2.1.</h:p>
	      <h:p>
              The rules for verification of identity are described in Section 6 of RFC 6125. 
              The reference identifier is typically established by configuration (e.g. configuring the name of the authentication server). 
              Based on a singular reference identifier’s source domain and application service type (e.g. HTTP, SIP, LDAP), 
              the client establishes all reference identifiers which are acceptable, such as a Common Name for the Subject Name field of the certificate and a (case-insensitive) DNS name for the Subject Alternative Name field. 
              The client then compares this list of all acceptable reference identifiers to the presented identifiers in the TLS server’s certificate.
	      </h:p>
	      <h:p>
              The preferred method for verification is the Subject Alternative Name using DNS names, URI names, or Service Names. 
              Verification using the Common Name is required for the purposes of backwards compatibility. 
              Additionally, support for use of IP addresses in the Subject Name or Subject Alternative name is discouraged as against best practices but may be implemented. 
              Finally, support for wildcards is discouraged but may be implemented. 
              If the client supports wildcards, the client must follow the best practices regarding matching; these best practices are captured in the evaluation activity.
	      </h:p>
            </note>
          </f-element>
          <f-element>
            <title>When the TSF negotiates a TLS_RSA_PSK cipher suite, the TSF shall  <selectables>
                <selectable>not establish the connection</selectable>
                <selectable>request authorization to establish the connection</selectable>
                <selectable><assignable>other action</assignable></selectable>
              </selectables> if the presented server certificate is deemed invalid.</title>
              <note role="application">
		<h:p>This requirement must be claimed if any ciphersuites beginning with 'TLS_RSA_PSK' are selected in FCS_RADSEC_EXT.2.1.</h:p>
		<h:p>
              Validity is determined by the identifier verification, certificate path, the expiration date, and the revocation status in accordance with RFC 5280. 
              Certificate validity is tested in accordance with testing performed for FIA_X509_EXT.1/Rev in the NDcPP.
		</h:p>
	      </note>
            <aactivity>
              <TSS>
                The evaluator will ensure that the TSS describes the client’s method of establishing all reference identifiers from the administrator and application-configured reference identifier, 
                including which types of reference identifiers are supported (e.g., Common Name, DNS Name, URI Name, Service Name, or other application-specific Subject Alternative Names) and whether IP addresses and wildcards are supported. 
                The evaluator will ensure that this description identifies whether and the manner in which certificate pinning is supported or used by the TOE.<h:br/><h:br/></TSS>
              <Guidance>
                The evaluator will verify that the operational guidance includes instructions for setting the reference identifier to be used for the purposes of certificate validation in TLS.<h:br/><h:br/>
	      </Guidance>
              <Tests>The evaluator will perform the following tests:
                <testlist>
                    <test>The evaluator will attempt to establish the connection using a server with a server certificate that contains the Server Authentication purpose in the extendedKeyUsage field and 
                      verify that a connection is established. The evaluator will then verify that the client rejects an otherwise valid server certificate that lacks the Server Authentication purpose in the extendedKeyUsage 
                      field and a connection is not established. Ideally, the two certificates should be identical except for the extendedKeyUsage field.</test>
                    <test>The evaluator will present a server certificate that does not contain an identifier in either the Subject Alternative Name (SAN) or Common Name (CN) that matches the reference identifier. 
                      The evaluator will verify that the connection fails.</test>
                    <test>The evaluator will present a server certificate that contains a CN that matches the reference identifier, 
                      contains the SAN extension, but does not contain an identifier in the SAN that matches the reference identifier. 
                      The evaluator will verify that the connection fails. The evaluator will repeat this test for each supported SAN type.</test>
                    <test>The evaluator will present a server certificate that contains a CN that does not match the reference identifier but does contain an identifier in the SAN that matches. 
                      The evaluator will verify that the connection succeeds.</test>
                      <test>
			[conditional] If the TOE does not mandate the presence of the SAN extension, the evaluator will present a server certificate that contains a CN that matches the reference identifier and does not contain the SAN extension. 
			The evaluator will verify that the connection succeeds.
			If the TOE does mandate the presence of the SAN extension, this test will be omitted.
		  </test>
                  <test>[conditional] If wildcards are supported by the TOE, the evaluator will perform the following tests: <h:ul>
                      <h:li>The evaluator will present a server certificate containing a wildcard that is not in the left-most label of the presented identifier (e.g. foo.*.example.com) and verify that the connection fails.</h:li>
                      <h:li>The evaluator will present a server certificate containing a wildcard in the left-most label but not preceding the public suffix (e.g. *.example.com). 
                        The evaluator will configure the reference identifier with a single left-most label (e.g. foo.example.com). 
                        The evaluator will verify that the connection succeeds. The evaluator will configure the reference identifier without a left-most label as in the certificate (e.g. example.com) and verify that the connection fails. 
                        The evaluator will configure the reference identifier with two left-most labels (e.g. bar.foo.example.com) and verify that the connection fails.</h:li>
                      <h:li>The evaluator will present a server certificate containing a wildcard in the left-most label immediately preceding the public suffix (e.g. *.com). 
                        The evaluator will configure the reference identifier with a single left-most label (e.g. foo.com) and verify that the connection fails. 
                        The evaluator will configure the reference identifier with two left-most labels (e.g. bar.foo.com) and verify that the connection fails.</h:li>
                    </h:ul>
                    </test>
                    <test>[conditional] If wildcards are not supported by the TOE, the evaluator will present a server certificate containing a wildcard and verify that the connection fails.</test>
                    <test>[conditional] If URI or Service name reference identifiers are supported, the evaluator will configure the DNS name and the service identifier. 
                      The evaluator will present a server certificate containing the correct DNS name and service identifier in the URIName or SRVName fields of the SAN and verify that the connection succeeds. 
                      The evaluator will repeat this test with the wrong service identifier (but correct DNS name) and verify that the connection fails.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        
      </sec:sel_fcs> 
      
      <sec:sel_fia title="Identification and Authentication (FIA)">
        
        <ext-comp-def title="Pre-Shared Key Composition" fam-id="FIA_PSK_EXT">
          <fam-behavior>Components in this family describe requirements for the creation and composition of pre-shared keys used to establish trusted communications channels.</fam-behavior> 
        </ext-comp-def> 
        
        <!-- moved from mandatory by TD0277 -->
        <f-component name="Pre-Shared Key Composition" cc-id="fia_psk_ext.1">
		  <depends on="s-radsec-psk"/>
          <consistency-rationale>This SFR defines parameters for pre-shared key generation. The Base-PP supports pre-shared keys as a potential authentication method for IPsec. This PP-Module 
            does not prevent this from being used but does define restrictions on how pre-shared keys may be generated and what constitutes an acceptable key. 
            This may also be used for RadSec, which is outside the original scope of the Base-PP.</consistency-rationale>
          
          <comp-lev>requires the TSF to support pre-shared keys that meet various characteristics for specific communications usage.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FCS_RBG.1 Random Bit Generation</dependencies>
          
          <f-element id="fel-use-psk">
            <title>The TSF shall be able to use pre-shared keys for <selectables>
              <selectable>RADIUS over TLS (RadSec)</selectable>
              <selectable>IPsec</selectable>
	      <selectable>WPA3-SAE</selectable>
	      <selectable>WPA3-SAE-PK</selectable>
              <selectable>IEEE 802.11 WPA2-PSK</selectable>
              <selectable><assignable>other protocols that use pre-shared keys</assignable></selectable>
            </selectables>. 
            </title>
          </f-element>
          <f-element id="fel-valid-psk">
            <title>The TSF shall be able to accept text-based pre-shared keys that: <h:ul>
              <h:li>are 22 characters and <selectables>
                <selectable><assignable>other supported lengths</assignable></selectable>
                <selectable exclusive="yes">no other lengths</selectable>
              </selectables>;</h:li>
              <h:li>are composed of any combination of upper and lower case letters, numbers, and special
                characters (that include: “!”, “@”, “#”, “$”, “%”, “^”, “&amp;”, “*”, “(“, and “)”).
              </h:li>
            </h:ul>
            </title>
          </f-element>
          <f-element id="fel-get-psk">
            <title>The TSF shall be able to <selectables> 
              <selectable>accept</selectable>
              <selectable>generate using the random bit generator specified in FCS_RBG.1</selectable>
            </selectables> bit-based pre-shared keys.
            </title>
          
            <note role="application">
	      <h:p>
		This requirement must be included if IPsec or another protocol that uses pre-shared keys is claimed, and pre-shared key authentication is selected 
          (e.g., "Pre-shared Keys" is selected in FCS_IPSEC_EXT.1.13 or "pre-shared keys" is selected in FCS_RADSEC_EXT.1.2). 
          The intent of this requirement is that all protocols will support both text-based and bit-based pre-shared keys.
	      </h:p>
	      <h:p>
		For the length of the text-based pre-shared keys, a common length (22 characters) is required to help
		promote interoperability.
		If other lengths are supported, they should be listed in the assignment;
		this assignment can also specify a range of values (e.g., "lengths from 5 to 55 characters") as well.
	      </h:p>
	      <h:p>
		For <xref to="fel-get-psk"/>, the ST author specifies whether the TSF merely accepts bit-based pre-shared keys
		or is capable of generating them.
		If it generates them, the requirement specifies that they must be
		generated using the RBG provided by the TOE.
	      </h:p>
          </note>
          <aactivity>
	    <TSS>
	      The evaluator will verify that the TSS describes 
	      <h:ol>
		<h:li>the protocols that can use pre-shared keys and that these are consistent with the selections made in <xref to="fel-use-psk"/>.</h:li>
		<h:li>the allowable values for pre-shared keys and that they are consistent with the selections made in <xref to="fel-valid-psk"/>.</h:li>
		<h:li>the way bit-based pre-shared keys are procured and that it is consistent with the selections made in <xref to="fel-get-psk"/>.</h:li>
	      </h:ol>
	    </TSS>
              <Guidance>
		  The evaluator will examine the operational guidance to determine that it provides guidance to
                administrators on the composition of strong text-based pre-shared keys, and (if the selection indicates
                keys of various lengths can be entered) that it provides information on the range of lengths supported.
                The guidance must specify the allowable characters for pre-shared keys, and that list must be a superset of the list contained in FIA_PSK_EXT.1.2.<h:br/><h:br/>
                The evaluator will confirm the operational guidance contains instructions for either entering bit-based
                pre-shared keys for each protocol identified in the requirement or for generating a bit-based pre-shared
                key (or both).<h:br/><h:br/>
	      </Guidance>
              <Tests>The evaluator will also perform the following tests for each protocol (or instantiation of a protocol, if
                performed by a different implementation on the TOE). Note that one or more of these tests can be
                performed with a single test case.
                <testlist>
                  <test>The evaluator will compose a pre-shared key of 22 characters that contains a combination of
                    the allowed characters in accordance with the operational guidance and demonstrates that a successful
                    protocol negotiation can be performed with the key.
                  </test>
                  <test>[conditional]: If the TOE supports pre-shared keys of multiple lengths, the evaluator will repeat
                    Test 1 using the minimum length; the maximum length; a length inside the allowable range; and invalid
                    lengths beyond the supported range (both higher and lower). The minimum, maximum, and included
                    length tests should be successful, and the invalid lengths must be rejected by the TOE.
                  </test>
                  <test>[conditional]: If the TOE does not generate bit-based pre-shared keys, the evaluator will obtain a
                    bit-based pre-shared key of the appropriate length and enter it according to the instructions in the
                    operational guidance. The evaluator will then demonstrate that a successful protocol negotiation can
                    be performed with the key.</test>
                  <test>[conditional]: If the TOE does generate bit-based pre-shared keys, the evaluator will generate a
                    bit-based pre-shared key of the appropriate length and use it according to the instructions in the
                    operational guidance. The evaluator will then demonstrate that a successful protocol negotiation can
                    be performed with the key.
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
      </sec:sel_fia> 

    </sel-sfrs>
    <obj-sfrs>
    </obj-sfrs>
    <impl-dep-sfrs></impl-dep-sfrs>
  </sec:Security_Requirements>
  
  <appendix title="Implicitly Satisfied Requirements" id="satisfiedreqs">
    This PP-Module has no implicitly satisfied requirements. All SFR dependencies are explicitly met either through SFRs defined by the PP-Module or inherited from the Base-PP. 
  </appendix>
  
  <appendix title="Allocation of Requirements in Distributed TOEs" id="allocation">
    
    For a distributed TOE, the security functional requirements in this PP-Module need to be met by the
    TOE as a whole, but not all SFRs will necessarily be implemented by all components. The
    following categories are defined in order to specify when each SFR must be implemented by a
    component: <h:ul>
      <h:li><h:b>All Components ("All")</h:b> &#8212;All components that comprise the distributed TOE must
        independently satisfy the requirement.</h:li>
      <h:li><h:b>At least one Component ("One")</h:b> &#8212;This requirement must be fulfilled by at least one
        component within the distributed TOE.</h:li>
      <h:li><h:b>Feature Dependent ("Feature Dependent")</h:b> &#8212; These requirements will only be
        fulfilled where the feature is implemented by the distributed TOE component (note
        that the requirement to meet the PP-Module as a whole requires that at least one component
        implements these requirements if they are claimed by the TOE).</h:li></h:ul>
    The table below specifies how each of the SFRs in this PP-Module must be met, using the categories above.
    
    <h:table>
      <h:tr class="header">
        <h:td>Requirement</h:td>
        <h:td>Description</h:td>
        <h:td>Distributed TOE SFR Allocation</h:td>
      </h:tr>
      <!--  
      <h:tr>
        <h:td>FCS_COP.1/DataEncryption</h:td>
        <h:td>Cryptographic Operation (AES Data Encryption/Decryption)</h:td>
        <h:td>All</h:td>
      </h:tr>
     <h:tr>
     <h:td>FPT_TST_EXT.1</h:td>
       <h:td>TSF Testing</h:td>
       <h:td>All</h:td> 
     </h:tr>
      <h:tr>
        <h:td>FTP_ITC.1</h:td>
        <h:td>Inter-TSF Trusted Channel</h:td>
        <h:td>One</h:td>
        </h:tr>
     -->
      <h:tr>
        <h:td>FAU_GEN.1/WLAN</h:td>
        <h:td>Audit Data Generation</h:td>
        <h:td>All</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_CKM.1/WPA</h:td>
        <h:td>Cryptographic Key Generation (Symmetric Keys for WPA2 Connections)</h:td>
        <h:td>One</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_CKM.2/GTK</h:td>
        <h:td>Cryptographic Key Distribution (GTK)</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_CKM.2/PMK</h:td>
        <h:td>Cryptographic Key Distribution (PMK)</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FIA_8021X_EXT.1</h:td>
        <h:td>802.1X Port Access Entity (Authenticator) Authentication</h:td>
        <h:td>One</h:td>
      </h:tr>
      <h:tr>
        <h:td>FIA_UAU.6</h:td>
        <h:td>Re-Authenticating</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FMT_SMF.1/AccessSystem</h:td>
        <h:td>Specification of Management Functions</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FMT_SMR_EXT.1</h:td>
        <h:td>No Administration from Client</h:td>
        <h:td>All</h:td>
      </h:tr>
      <h:tr>
        <h:td>FPT_FLS.1/AS</h:td>
        <h:td>Failure with Preservation of Secure State</h:td>
        <h:td>All</h:td>
      </h:tr>
      <h:tr>
        <h:td>FTA_TSE.1</h:td>
        <h:td>TOE Session Establishment</h:td>
        <h:td>All</h:td>
      </h:tr>
      <h:tr>
        <h:td>FTP_ITC.1/Client</h:td>
        <h:td>Inter-TSF Trusted Channel (WLAN Client Communications)</h:td>
        <h:td>All</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_CKM.2/DISTRIB</h:td>
        <h:td>Cryptographic Key Distribution (802.11 Keys)</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_RADSEC_EXT.1</h:td>
        <h:td>RadSec</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_RADSEC_EXT.2</h:td>
        <h:td>RadSec using Pre-Shared Keys</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FCS_RADSEC_EXT.3</h:td>
        <h:td>RadSec using Pre-Shared Keys and RSA</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
      <h:tr>
        <h:td>FIA_PSK_EXT.1</h:td>
        <h:td>Pre-Shared Key Composition</h:td>
        <h:td>Feature Dependent</h:td>
      </h:tr>
    </h:table>
    
  </appendix>
  
  <appendix title="Entropy Documentation and Assessment" id="EAR">
    The TOE does not require any additional supplementary information to describe its entropy sources beyond the requirements outlined in the Base-PP.  
  </appendix>
  
  <bibliography>
    <cc-entry/>
    <entry id="bibNDcPP">
      <tag>NDcPP</tag>
      <description>
        <h:a href="https://www.niap-ccevs.org/protectionprofiles/524">
          collaborative Protection Profile for Network Devices, Version 4.0, December 22, 2025</h:a>
      </description>
    </entry>
  </bibliography>
    
</Module>
